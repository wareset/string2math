/* eslint-disable */
var t=Array.prototype.concat;function e(){return t.apply([],arguments)}function r(t){return t[t.length-1]}class ProgramNode{constructor(t){this.type="Program",this.is=t}toArray(){return this.is?this.is.toArray():["NaN"]}toString(){return""+(this.is||NaN)}calculate(){return this.is?this.is.calculate.apply(this.is,arguments):NaN}}class ParenthesisNode{constructor(t){this.type="Parenthesis",this.is=t}toArray(){return this.is?this.is.toArray():["NaN"]}toString(){return""+(this.is||NaN)}calculate(){return this.is?this.is.calculate.apply(this.is,arguments):NaN}}class ConditionalNode{constructor(t,e,r){this.type="Conditional",this.is=r,this.isTrue=e,this.isFalse=t}toArray(){return e("(",this.is?this.is.toArray():"NaN","?",this.isTrue?this.isTrue.toArray():"NaN",":",this.isFalse?this.isFalse.toArray():"NaN",")")}toString(){return`(${this.is||NaN} ? ${this.isTrue||NaN} : ${this.isFalse||NaN})`}calculate(){var t=this.is,e=this.isTrue,r=this.isFalse,n=arguments;return t?t.calculate.apply(t,n):r?r.calculate.apply(e,n):NaN}}class ConstantNode{constructor(t){this.type="Constant",this.is=t}toArray(){return[this.is]}toString(){return""+this.is}calculate(){for(var t,e=this.is,r=arguments,n=r.length;n-- >0;)if(e in(t=r[n])&&"function"!=typeof(t=t[e]))return t;var i=+e;return i==i||"NaN"===e?i:e}}function n(t,r){return 0===r?t.toArray():e(",",t.toArray())}function i(t){return t.calculate.apply(t,this)}class FunctionNode{constructor(t,e){this.type="Function",this.is=t,this.isArgs=e}toArray(){return e(this.is+"(",e.apply(void 0,this.isArgs.map(n)),")")}toString(){return`${this.is}(${this.isArgs.join(", ")})`}calculate(){for(var t,e=this.is,r=arguments,n=r.length;n-- >0;)if(e in(t=r[n])&&"function"==typeof(t=t[e]))return t.apply(void 0,this.isArgs.map(i,r));return NaN}}class OperatorNode{constructor(t,e,r){this.type="Operator",this.is=t,this.isLeft=r,this.isRight=e}toArray(){var t=this.is,r=this.isLeft,n=this.isRight,i=r?r.toArray():["NaN"],s=n?n.toArray():["NaN"];return n?r?"!"===t||"~"===t?["NaN"]:e("(",i,t,s,")"):"!"===t||"~"===t||"-"===t?e(t,s):s:i}toString(){var t=this.is,e=this.isLeft,r=this.isRight,n=""+(e||NaN),i=""+(r||NaN);return r?e?"!"===t||"~"===t?"NaN":`(${n} ${t} ${i})`:"!"===t||"~"===t||"-"===t?t+i:i:n}calculate(){var t,e=this.is,r=this.isLeft,n=this.isRight,i=arguments,s=r?r.calculate.apply(r,i):NaN,a=n?n.calculate.apply(n,i):NaN;if(!n)return s;for(var o,u=i.length;u-- >0;)if(e in(o=i[u])&&"function"==typeof(o=o[e])){t=o;break}if(!r)return"-"===e?t?t(0,a):-a:"!"===e?t?t(a):+!a:"~"===e?t?t(a):~a:a;if(t)return t(s,a);switch(e){case"**":return Math.pow(s,a);case"*":return s*a;case"/":return s/a;case"%":return s%a;case"+":return+(s+a);case"-":return s-a;case"<<":return s<<a;case">>":return s>>a;case">>>":return s>>>a;case"<":return s<a?1:0;case"<=":return s<=a?1:0;case">":return s>a?1:0;case">=":return s>=a?1:0;case"=":case"==":return s==a?1:0;case"===":return s===a?1:0;case"!=":return s!=a?1:0;case"!==":return s!==a?1:0;case"&":return s&a;case"^":return s^a;case"|":return s|a;case"&&":return s?a:s;case"||":return s||a;case"??":return s==s?s:a}return NaN}}var s=/\?\??|\|\|?|\*\*?|&&?|<<|>>>?|[!=]=?=?|[<>]=?|(?<!\d\.?[eE])[-+]|[,:~^%/()[\]]/g,a={"!":14,"~":14,"**":13,"*":12,"/":12,"%":12,"+":11,"-":11,"<<":10,">>":10,">>>":10,"<":9,"<=":9,">":9,">=":9,"=":8,"==":8,"!=":8,"===":8,"!==":8,"&":7,"^":6,"|":5,"&&":4,"||":3,"??":3,"?":2,":":2,",":1};function o(t,n,i,s,a,u,c){if(u[n]&&u[n].length)for(var h,l=u[n],N=l.length;N-- >0;)if((h=l[N]-i)>-1&&h<t.length)return l.splice(N,1),e(o(t.slice(0,h),n,i,s,a,u,c),o(t.slice(h+1),n,i+h+1,s,a,u,c));if(a[n]&&a[n].length)for(var p,f,g=a[n],y=g.length;y-- >0;)if(p=g[y].f-i,f=g[y].s-i,p>-1&&p<t.length&&f>p)return g.splice(y,1),new ConditionalNode(r(e(o(t.slice(f+1),n,i+f+1,s,a,u,c))),r(e(o(t.slice(p+1,f),n,i+p+1,s,a,u,c))),r(e(o(t.slice(0,p),n,i,s,a,u,c))));if(c[n]&&c[n].length)for(var d,v=c[n],x=v.length;x-- >0;)if((d=v[x]-i)>-1&&d<t.length)return v.splice(x,1),new OperatorNode(t[d],r(e(o(t.slice(d+1),n,i+d+1,s,a,u,c))),r(e(o(t.slice(0,d),n,i,s,a,u,c))));if(s[n]&&s[n].length)for(var A,w,b=s[n],k=b.length;k-- >0;)if(A=b[k].f-i,w=b[k].s-i,A>-1&&A<t.length&&w>A)return b.splice(k,1),"("===t[A]?new ParenthesisNode(r(e(o(t.slice(A+1,w),n+1,i+A+1,s,a,u,c)))):new FunctionNode(t[A],e(o(t.slice(A+2,w),n+1,i+A+2,s,a,u,c)));var m=t.join("");return m?new ConstantNode(m):[]}function u(t,e,r,n){t[e]||(t[e]=[]),t[e][r]||(t[e][r]=[]),t[e][r][r===a["**"]?"unshift":"push"](n.length)}function c(t,e,r){u(t,e,a["*"],r),r.push("*")}function h(t){t="("+t+")";var n,i,h,l,N,p=[],f=0,g="",y=0,d=0,v={},x={},A={},w={},b=a["!"],k={},m={},F={};for(s.lastIndex=0;N=s.exec(t);)switch(n=N[0]){case"[":d++;break;case"]":d--;break;default:if(0!==d)break;switch(N.index>f&&(i=t.slice(f,N.index).trim())&&(")"===g&&c(F,y,p),p.push(g=i)),n){case"(":x[y]||(x[y]=[]),x[y].push({f:p.length,s:-1}),!g||"("===g||a[g]>0||(t[N.index-1].trim()&&"NaN"!==g&&""+ +g=="NaN"?(h=x[y]&&r(x[y]))&&h.f--:(c(F,y,p),(h=x[y]&&r(x[y]))&&h.f++)),y++;break;case")":(h=x[--y]&&r(x[y]))&&(h.s=p.length,(v[y]||(v[y]=[])).push(x[y].pop()));break;default:switch(")"!==g||a[n]>0||(c(F,y,p),g="*"),n){case",":k[y]||(k[y]=[]),k[y].push(p.length);break;case"?":w[y]||(w[y]=[]),w[y].push({f:p.length,s:-1});break;case":":(h=w[y]&&r(w[y]))&&(h.s=p.length,(A[y]||(A[y]=[])).push(w[y].pop()));break;default:if("("===g||a[g]>0){if("-"!==n&&"!"!==n&&"~"!==n){f=N.index+n.length;continue}l=++b}else l=a[n];u(F,y,l,p)}}f=N.index+n.length,p.push(g=n)}for(var $ in F){m[$]=[];for(var C=F[$],P=C.length;P-- >0;)C[P]&&Array.prototype.push.apply(m[$],C[P])}return new ProgramNode(r(e(o(p.slice(1,-1),1,1,v,A,k,m))))}var l=/^(NaN)?([-]?)(Infinity)?(\d*)\.?(\d*)[eE]?([-+]?\d*)$/,N=/^0+/;function p(t){var e=(0!=(t=+t)||1/t>0?""+t:"-0").match(l);return{isNaN:!!e[1],isMinus:"-"===e[2],isInfinity:!!e[3],integer:(e[4]+e[5]).replace(N,""),exponent:+e[6]-e[5].length}}function f(t){return t.isNaN?NaN:t.isInfinity?t.isMinus?-1/0:1/0:+((t.isMinus?"-":"")+(t.integer||"0")+"e"+t.exponent)}function g(t,e){if(t=+t,0===(e=+e))return 1;if(e!=e||t!=t)return NaN;if(e===1/0)return t?-1===t||1===t?NaN:t>1||t<-1?e:0:0;if(e===-1/0)return t?-1===t||1===t?NaN:t>1||t<-1?0:-e:-e;e<0&&(t=v(1,t),e=-e);for(var r=1,n=0;++n<=e;)r=d(r,t);return(e=A(e,1-n))>0&&(r=0===(r=d(r,Math.pow(t,e)))?0:r<0?-r:r),r}function y(t,e){var r=t.exponent,n=e.exponent;return r>n?n:r}function d(t,e){var r=p(t=+t),n=p(e=+e),i=y(r,n);r.exponent-=i,n.exponent-=i;var s=p(f(r)*f(n));return s.exponent+=i+i,f(s)}function v(t,e){var r=p(t=+t),n=p(e=+e),i=y(r,n);return r.exponent-=i,n.exponent-=i,f(r)/f(n)}function x(t,e){var r=p(t=+t),n=p(e=+e),i=y(r,n);r.exponent-=i,n.exponent-=i;var s=p(f(r)%f(n));return s.exponent+=i,f(s)}function A(t,e){var r=p(t=+t),n=p(e=+e),i=y(r,n);r.exponent-=i,n.exponent-=i;var s=p(f(r)+f(n));return s.exponent+=i,f(s)}function w(t,e){var r=p(t=+t),n=p(e=+e),i=y(r,n);r.exponent-=i,n.exponent-=i;var s=p(f(r)-f(n));return s.exponent+=i,f(s)}export{ConditionalNode,ConstantNode,FunctionNode,OperatorNode,ParenthesisNode,ProgramNode,A as add,h as create,h as default,v as div,g as exp,d as mul,p as num2raw,f as raw2num,x as rem,w as sub};
