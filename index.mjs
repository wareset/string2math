/* eslint-disable */
var t=Array.prototype;function n(){return t.concat.apply([],arguments)}function e(t){return t[t.length-1]}var i=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n},r=Math.pow,s=/^(NaN)?([-]?)(Infinity)?(\d*)\.?(\d*)[eE]?([-+]?\d*)$/,a=/^0+/;function o(t){var n=(0!=(t=+t)||1/t>0?""+t:"-0").match(s);return{isNaN:!!n[1],isMinus:"-"===n[2],isInfinity:!!n[3],integer:(n[4]+n[5]).replace(a,""),exponent:+n[6]-n[5].length}}function u(t){return t.isNaN?NaN:t.isInfinity?t.isMinus?-1/0:1/0:+((t.isMinus?"-":"")+(t.integer||"0")+"e"+t.exponent)}function c(t,n){if(t=+t,0===(n=+n))return 1;if(n!=n||t!=t)return NaN;if(n===1/0)return t?-1===t||1===t?NaN:t>1||t<-1?n:0:0;if(n===-1/0)return t?-1===t||1===t?NaN:t>1||t<-1?0:-n:-n;n<0&&(t=l(1,t),n=-n);for(var e=1,i=0;++i<=n;)e=h(e,t);return(n=p(n,1-i))>0&&(e=+(""+h(e,r(t,n))))<0&&(e=-e),e}function h(t,n){var e=o(t),i=o(n),r=e.exponent,s=i.exponent,a=(r>s?s-r:r-s)||r;e.exponent-=a,i.exponent-=a;var c=o(u(e)*u(i));return c.exponent+=a+a,u(c)}function l(t,n){var e=o(t),i=o(n),r=e.exponent,s=i.exponent,a=(r>s?s-r:r-s)||r;return e.exponent-=a,i.exponent-=a,u(e)/u(i)}function f(t,n){var e=o(t),i=o(n),r=e.exponent,s=i.exponent,a=(r>s?s-r:r-s)||r;e.exponent-=a,i.exponent-=a;var c=o(u(e)%u(i));return c.exponent+=a,u(c)}function p(t,n){var e=o(t),i=o(n),r=e.exponent,s=i.exponent,a=(r>s?s-r:r-s)||r;e.exponent-=a,i.exponent-=a;var c=o(u(e)+u(i));return c.exponent+=a,u(c)}function N(t,n){return p(t,-n)}var g=/\?\??|\|\|?|\*\*?|&&?|<<|>>>?|[!=]=?=?|[<>]=?|(?<!\d\.?[eE])[-+]|[,:~^%/()[\]]/g,y=function(){function ProgramNode(t){this.type="Program",this.is=t}var t=ProgramNode.prototype;return t.toArray=function(t){return this.is?this.is.toArray(t):["NaN"]},t.toString=function(){return""+(this.is||NaN)},t.calculate=function(){return this.is?this.is.calculate.apply(this.is,arguments):NaN},ProgramNode}(),d=function(){function ParenthesisNode(t){this.type="Parenthesis",this.is=t}var t=ParenthesisNode.prototype;return t.toArray=function(t){var e=this.is,i=n(e?e.toArray(t):"NaN");return t&&"("!==i[0]?n("(",i,")"):i},t.toString=function(){return"("+(this.is||NaN)+")"},t.calculate=function(){return this.is?this.is.calculate.apply(this.is,arguments):NaN},ParenthesisNode}(),v=function(){function ConditionalNode(t,n,e){this.type="Conditional",this.is=e,this.isTrue=n,this.isFalse=t}var t=ConditionalNode.prototype;return t.toArray=function(t){var e=n(this.is?this.is.toArray(t):"NaN","?",this.isTrue?this.isTrue.toArray(t):"NaN",":",this.isFalse?this.isFalse.toArray(t):"NaN");return t?n("(",e,")"):e},t.toString=function(){return(this.is||NaN)+" ? "+(this.isTrue||NaN)+" : "+(this.isFalse||NaN)},t.calculate=function(){var t=this.is,n=this.isTrue,e=this.isFalse,i=arguments;return t?t.calculate.apply(t,i):e?e.calculate.apply(n,i):NaN},ConditionalNode}(),x=function(){function ConstantNode(t){this.type="Constant",this.is=t}var t=ConstantNode.prototype;return t.toArray=function(){return[this.is]},t.toString=function(){return this.is},t.calculate=function(){for(var t=this.is,n=arguments,e=n.length;e-- >0;)if(t in n[e]&&"function"!=typeof n[e])return+n[e][t];return+t},ConstantNode}();function A(t,e){return 0===e?t.toArray(this[0]):n(",",t.toArray(this[0]))}function w(t){return t.calculate.apply(t,this)}var C=function(){function FunctionNode(t,n){this.type="Function",this.is=t,this.isArgs=n}var t=FunctionNode.prototype;return t.toArray=function(t){return n(this.is,"(",n.apply(void 0,this.isArgs.map(A,[t])),")")},t.toString=function(){return this.is+"("+this.isArgs.join(", ")+")"},t.calculate=function(){for(var t=this.is,n=arguments,e=n.length;e-- >0;)if(t in n[e]&&"function"==typeof n[e][t])return+n[e][t].apply(void 0,this.isArgs.map(w,n));return NaN},FunctionNode}(),m=function(){function OperatorNode(t,n,e){this.type="Operator",this.is=t,this.isLeft=e,this.isRight=n}var t=OperatorNode.prototype;return t.toArray=function(t){var e=this.is,i=this.isLeft,r=this.isRight,s=i?i.toArray(t):["NaN"],a=r?r.toArray(t):["NaN"];return r?i?"!"===e||"~"===e?["NaN"]:t?n("(",s,e,a,")"):n(s,e,a):"!"===e||"~"===e||"-"===e?n(e,a):a:s},t.toString=function(){var t=this.is,n=this.isLeft,e=this.isRight,i=""+(n||NaN),r=""+(e||NaN);return e?n?"!"===t||"~"===t?"NaN":i+" "+t+" "+r:"!"===t||"~"===t||"-"===t?t+r:r:i},t.calculate=function(){var t,n=this.is,e=this.isLeft,r=this.isRight,s=arguments,a=e?e.calculate.apply(e,s):NaN,o=r?r.calculate.apply(r,s):NaN;if(!r)return a;for(var u=s.length;u-- >0;)if(n in s[u]&&"function"==typeof s[u][n]){t=s[u][n];break}if(!e)return"-"===n?t?+t(-o,0):-o:"!"===n?t?+t(o):+!o:"~"===n?t?+t(o):~o:o;if(t)return+t(a,o);switch(n){case"**":return c(a,o);case"*":return h(a,o);case"/":return l(a,o);case"%":return f(a,o);case"+":return p(a,o);case"-":return p(a,-o);case"<<":return a<<o;case">>":return a>>o;case">>>":return a>>>o;case"<":return a<o?1:0;case"<=":return a<=o?1:0;case">":return a>o?1:0;case">=":return a>=o?1:0;case"=":case"==":return a===o?1:0;case"===":return i(a,o)?1:0;case"!=":return a!==o?1:0;case"!==":return i(a,o)?0:1;case"&":return a&o;case"^":return a^o;case"|":return a|o;case"&&":return a?o:a;case"||":return a||o;case"??":return a==a?a:o}return NaN},OperatorNode}(),b={"!":14,"~":14,"**":13,"*":12,"/":12,"%":12,"+":11,"-":11,"<<":10,">>":10,">>>":10,"<":9,"<=":9,">":9,">=":9,"=":8,"==":8,"!=":8,"===":8,"!==":8,"&":7,"^":6,"|":5,"&&":4,"||":3,"??":3,"?":2,":":2,",":1};function O(t,i,r,s,a,o,u){if(o[i]&&o[i].length)for(var c,h=o[i],l=h.length;l-- >0;)if((c=h[l]-r)>-1&&c<t.length)return h.splice(l,1),n(O(t.slice(0,c),i,r,s,a,o,u),O(t.slice(c+1),i,r+c+1,s,a,o,u));if(a[i]&&a[i].length)for(var f,p,N=a[i],g=N.length;g-- >0;)if(f=N[g].f-r,p=N[g].s-r,f>-1&&f<t.length&&p>f)return N.splice(g,1),new v(e(n(O(t.slice(p+1),i,r+p+1,s,a,o,u))),e(n(O(t.slice(f+1,p),i,r+f+1,s,a,o,u))),e(n(O(t.slice(0,f),i,r,s,a,o,u))));if(u[i]&&u[i].length)for(var y,A=u[i],w=A.length;w-- >0;)if((y=A[w]-r)>-1&&y<t.length)return A.splice(w,1),new m(t[y],e(n(O(t.slice(y+1),i,r+y+1,s,a,o,u))),e(n(O(t.slice(0,y),i,r,s,a,o,u))));if(s[i]&&s[i].length)for(var b,F,L=s[i],S=L.length;S-- >0;)if(b=L[S].f-r,F=L[S].s-r,b>-1&&b<t.length&&F>b)return L.splice(S,1),"("===t[b]?new d(e(n(O(t.slice(b+1,F),i+1,r+b+1,s,a,o,u)))):new C(t[b],n(O(t.slice(b+2,F),i+1,r+b+2,s,a,o,u)));var k=t.join("");return k?new x(k):[]}function F(t,n,e,i){t[n]||(t[n]=[]),t[n][e]||(t[n][e]=[]),t[n][e][e===b["**"]?"unshift":"push"](i.length)}function L(t,n,e){F(t,n,b["*"],e),e.push("*")}function S(i){i="("+i+")",g.lastIndex=0;for(var r,s,a,o,u,c=[],h=0,l="",f=0,p=0,N={},d={},v={},x={},A=b["!"],w={},C={},m={};u=g.exec(i);)switch(r=u[0]){case"[":p++;break;case"]":p--;break;default:if(0!==p)break;switch(u.index>h&&(s=i.slice(h,u.index).trim())&&(")"===l&&L(m,f,c),c.push(l=s)),r){case"(":d[f]||(d[f]=[]),d[f].push({f:c.length,s:-1}),!l||"("===l||b[l]>0||(i[u.index-1].trim()&&"NaN"!==l&&""+ +l=="NaN"?(a=d[f]&&e(d[f]))&&a.f--:(L(m,f,c),(a=d[f]&&e(d[f]))&&a.f++)),f++;break;case")":(a=d[--f]&&e(d[f]))&&(a.s=c.length,(N[f]||(N[f]=[])).push(d[f].pop()));break;default:switch(")"!==l||b[r]>0||(L(m,f,c),l="*"),r){case",":w[f]||(w[f]=[]),w[f].push(c.length);break;case"?":x[f]||(x[f]=[]),x[f].push({f:c.length,s:-1});break;case":":(a=x[f]&&e(x[f]))&&(a.s=c.length,(v[f]||(v[f]=[])).push(x[f].pop()));break;default:if("("===l||b[l]>0){if("-"!==r&&"!"!==r&&"~"!==r){h=u.index+r.length;continue}o=++A}else o=b[r];F(m,f,o,c)}}h=u.index+r.length,c.push(l=8===b[r]?r[0]+"="+(r[2]||""):r)}for(var S in m){C[S]=[];for(var k=m[S],R=k.length;R-- >0;)k[R]&&t.push.apply(C[S],k[R])}return new y(e(n(O(c.slice(1,-1),1,1,N,v,w,C))))}var k={"(":"Opening parenthesis",")":"Closing parenthesis","!":"Logical NOT","~":"Bitwise NOT","**":"Exponentiation","*":"Multiplication","/":"Division","%":"Remainder","+":"Addition","-":"Subtraction","<<":"Bitwise left shift",">>":"Bitwise right shift",">>>":"Bitwise unsigned right shift","<":"Less than","<=":"Less than or equal",">":"Greater than",">=":"Greater than or equal","=":"Equality","==":"Equality","!=":"Inequality","===":"Strict equality","!==":"Strict inequality","&":"Bitwise AND","^":"Bitwise XOR","|":"Bitwise OR","&&":"Logical AND","||":"Logical OR","??":"Coalescing NaN","?":"Conditional TRUE",":":"Conditional FALSE",",":"Comma"};export{v as ConditionalNode,x as ConstantNode,C as FunctionNode,k as OPERATORS,m as OperatorNode,d as ParenthesisNode,y as ProgramNode,p as add,S as create,S as default,l as div,c as exp,h as mul,o as num2raw,u as raw2num,f as rem,N as sub};
