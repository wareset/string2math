/* eslint-disable */
var t=Array.prototype;function n(){return t.concat.apply([],arguments)}function e(t){return t[t.length-1]}var r=Math.pow,i=/^(NaN)?([-]?)(Infinity)?(\d*)\.?(\d*)[eE]?([-+]?\d*)$/,s=/^0+/;function a(t){var n=(+t+"").match(i);return{isNaN:!!n[1],isMinus:"-"===n[2],isInfinity:!!n[3],integer:(n[4]+n[5]).replace(s,""),exponent:+n[6]-n[5].length}}function o(t){return t.isNaN?NaN:t.isInfinity?t.isMinus?-1/0:1/0:+((t.isMinus?"-":"")+(t.integer||"0")+"e"+t.exponent)}function u(t,n){if(t=+t,0===(n=+n))return 1;if(n!=n||t!=t)return NaN;if(n===1/0)return n;if(0===t||n===-1/0)return 0;if(t===1/0||t===-1/0)return t;n<0&&(t=h(1,t),n=-n);for(var e=1,i=0;++i<=n;)e=c(e,t);return(n=l(n,1-i))>0&&(e=c(e,r(t,n))),e}function c(t,n){var e=a(t),r=a(n),i=e.exponent,s=r.exponent,u=(i>s?s-i:i-s)||i;e.exponent-=u,r.exponent-=u;var c=a(o(e)*o(r));return c.exponent+=u+u,o(c)}function h(t,n){var e=a(t),r=a(n),i=e.exponent,s=r.exponent,u=(i>s?s-i:i-s)||i;return e.exponent-=u,r.exponent-=u,o(e)/o(r)}function f(t,n){var e=a(t),r=a(n),i=e.exponent,s=r.exponent,u=(i>s?s-i:i-s)||i;e.exponent-=u,r.exponent-=u;var c=a(o(e)%o(r));return c.exponent+=u,o(c)}function l(t,n){var e=a(t),r=a(n),i=e.exponent,s=r.exponent,u=(i>s?s-i:i-s)||i;e.exponent-=u,r.exponent-=u;var c=a(o(e)+o(r));return c.exponent+=u,o(c)}function p(t,n){return l(t,-n)}var N=/\?\??|\|\|?|\*\*?|&&?|<<|>>>?|[!=]=?=?|[<>]=?|(?<!\d\.?[eE])[-+]|[,:~^%/()[\]]/g,g=function(){function ProgramNode(t){this.type="Program",this.is=t}var t=ProgramNode.prototype;return t.toArray=function(){return this.is?this.is.toArray():["NaN"]},t.toString=function(){return""+(this.is||NaN)},t.calculate=function(){return this.is?this.is.calculate(arguments):NaN},ProgramNode}(),y=function(){function ParenthesisNode(t){this.type="Parenthesis",this.is=t}var t=ParenthesisNode.prototype;return t.toArray=function(){return n("(",this.is?this.is.toArray():"NaN",")")},t.toString=function(){return"("+(this.is||NaN)+")"},t.calculate=function(){return this.is?this.is.calculate(arguments):NaN},ParenthesisNode}(),d=function(){function ConditionalNode(t,n,e){this.type="Conditional",this.is=e,this.isTrue=n,this.isFalse=t}var t=ConditionalNode.prototype;return t.toArray=function(){return n(this.is?this.is.toArray():"NaN","?",this.isTrue?this.isTrue.toArray():"NaN",":",this.isFalse?this.isFalse.toArray():"NaN")},t.toString=function(){return"("+(this.is||NaN)+" ? "+(this.isTrue||NaN)+" : "+(this.isFalse||NaN)+")"},t.calculate=function(){var t=this.is,n=(this.isTrue,this.isFalse),e=arguments;return t?t.calculate(e):n?n.calculate(e):NaN},ConditionalNode}(),v=function(){function ConstantNode(t){this.type="Constant",this.is=t}var t=ConstantNode.prototype;return t.toArray=function(){return[this.is]},t.toString=function(){return this.is},t.calculate=function(){for(var t=this.is,n=arguments,e=n.length;e-- >0;)if(t in n[e]&&"function"!=typeof n[e])return+n[e][t];return+t},ConstantNode}();function x(t,e){return 0===e?t.toArray():n(",",t.toArray())}function A(t){return t.calculate.apply(void 0,this)}var w=function(){function FunctionNode(t,n){this.type="Function",this.is=t,this.isArgs=n}var t=FunctionNode.prototype;return t.toArray=function(){return n(this.is+"(",n.apply(void 0,this.isArgs.map(x)),")")},t.toString=function(){return this.is+"("+this.isArgs.join(", ")+")"},t.calculate=function(){for(var t=this.is,n=arguments,e=n.length;e-- >0;)if(t in n[e]&&"function"==typeof n[e][t])return+n[e][t].apply(void 0,this.isArgs.map(A,n));return NaN},FunctionNode}(),F=function(){function OperatorNode(t,n,e){this.type="Operator",this.is=t,this.isLeft=e,this.isRight=n}var t=OperatorNode.prototype;return t.toArray=function(){var t=this.is,e=this.isLeft,r=this.isRight,i=e?e.toArray():["NaN"],s=r?r.toArray():["NaN"];return r?e?"!"===t||"~"===t?["NaN"]:n(i,t,s):!r||"-"!==t&&"!"!==t&&"~"!==t?s:n(t,s):e&&"%"===t?n(i,t):i},t.toString=function(){var t=this.is,n=this.isLeft,e=this.isRight,r=""+(n||NaN),i=""+(e||NaN);return e?n?"!"===t||"~"===t?"NaN":"("+r+" "+t+" "+i+")":!e||"-"!==t&&"!"!==t&&"~"!==t?i:t+i:n&&"%"===t?r+t:r},t.calculate=function(){var t=this.is,n=this.isLeft,e=this.isRight,r=arguments,i=n?n.calculate(r):NaN,s=e?e.calculate(r):NaN;if(!e)return n&&"%"===t?h(i,100):i;if(!n){if(e){if("-"===t)return-s;if("!"===t)return+!s;if("~"===t)return~s}return s}for(var a=r.length;a-- >0;)if(t in r[a]&&"function"==typeof r[a][t])return+r[a][t](i,s);switch(t){case"**":return u(i,s);case"*":return c(i,s);case"/":return h(i,s);case"%":return f(i,s);case"+":return l(i,s);case"-":return l(i,-s);case"<<":return i<<s;case">>":return i>>s;case">>>":return i>>>s;case"<":return i<s?1:0;case"<=":return i<=s?1:0;case">":return i>s?1:0;case">=":return i>=s?1:0;case"=":case"==":case"===":return i===s?1:0;case"!=":case"!==":return i!==s?1:0;case"&":return i&s;case"^":return i^s;case"|":return i|s;case"&&":return i?s:i;case"||":return i||s;case"??":return i==i?i:s}return NaN},OperatorNode}(),b={"!":14,"~":14,"**":13,"*":12,"/":12,"%":12,"+":11,"-":11,"<<":10,">>":10,">>>":10,"<":9,"<=":9,">":9,">=":9,"=":8,"==":8,"!=":8,"===":8,"!==":8,"&":7,"^":6,"|":5,"&&":4,"||":3,"??":3,"?":2,":":2,",":1};function k(t,r,i,s,a,o,u){if(o[r]&&o[r].length)for(var c,h=o[r],f=h.length;f-- >0;)if((c=h[f]-i)>-1&&c<t.length)return h.splice(f,1),n(k(t.slice(0,c),r,i,s,a,o,u),k(t.slice(c+1),r,i+c+1,s,a,o,u));if(a[r]&&a[r].length)for(var l,p,N=a[r],g=N.length;g-- >0;)if(l=N[g].f-i,p=N[g].s-i,l>-1&&l<t.length&&p>l)return N.splice(g,1),new d(e(n(k(t.slice(p+1),r,i+p+1,s,a,o,u))),e(n(k(t.slice(l+1,p),r,i+l+1,s,a,o,u))),e(n(k(t.slice(0,l),r,i,s,a,o,u))));if(u[r]&&u[r].length)for(var x,A=u[r],m=A.length;m-- >0;)if((x=A[m]-i)>-1&&x<t.length){if(m>0&&"%"!==t[x-1]&&(b[t[x-1]]||"%"===t[x]&&(!t[x+1]||b[t[x+1]]<b["~"])))continue;return A.splice(m,1),new F(t[x],e(n(k(t.slice(x+1),r,i+x+1,s,a,o,u))),e(n(k(t.slice(0,x),r,i,s,a,o,u))))}if(s[r]&&s[r].length)for(var C,P,S=s[r],T=S.length;T-- >0;)if(C=S[T].f-i,P=S[T].s-i,C>-1&&C<t.length&&P>C)return S.splice(T,1),"("===t[C]?new y(e(n(k(t.slice(C+1,P),r+1,i+C+1,s,a,o,u)))):new w(t[C],n(k(t.slice(C+2,P),r+1,i+C+2,s,a,o,u)));var I=t.join("");return I?new v(I):[]}function m(t,n,e,r){t[n]||(t[n]=[]),t[n][e]||(t[n][e]=[]),t[n][e][e===b["**"]?"unshift":"push"](r.length)}function C(t,n,e){m(t,n,b["*"],e),e.push("*")}function P(r){r="("+r+")",N.lastIndex=0;for(var i,s,a,o,u=[],c=0,h="",f=0,l=0,p={},y={},d={},v={},x={},A={},w={};o=N.exec(r);)switch(i=o[0]){case"[":l++;break;case"]":l--;break;default:if(0!==l)break;switch(o.index>c&&(s=r.slice(c,o.index).trim())&&(")"===h&&C(w,f,u),u.push(h=s)),i){case"(":y[f]||(y[f]=[]),y[f].push({f:u.length,s:-1}),h&&(/^[a-z][$\w]*$/.test(h)?(a=y[f]&&e(y[f]))&&a.f--:"("===h||b[h]||(C(w,f,u),(a=y[f]&&e(y[f]))&&a.f++)),f++;break;case")":(a=y[--f]&&e(y[f]))&&(a.s=u.length,(p[f]||(p[f]=[])).push(y[f].pop()));break;default:switch(")"!==h||b[i]||(C(w,f,u),h="*"),i){case",":x[f]||(x[f]=[]),x[f].push(u.length);break;case"?":v[f]||(v[f]=[]),v[f].push({f:u.length,s:-1});break;case":":(a=v[f]&&e(v[f]))&&(a.s=u.length,(d[f]||(d[f]=[])).push(v[f].pop()));break;default:m(w,f,b[i],u)}}u.push(h=i),c=o.index+i.length}for(var F in w){A[F]=[];for(var P=w[F],S=P.length;S-- >0;)P[S]&&t.push.apply(A[F],P[S])}return new g(e(n(k(u.slice(1,-1),1,1,p,d,x,A))))}export{d as ConditionalNode,v as ConstantNode,w as FunctionNode,F as OperatorNode,y as ParenthesisNode,g as ProgramNode,l as add,P as create,P as default,h as div,u as exp,c as mul,a as num2raw,o as raw2num,f as rem,p as sub};
