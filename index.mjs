/* eslint-disable */
function t(t){return t?t.toArray():[NaN]}function e(t,e){return t?t.calculate.apply(t,e):NaN}function r(t){return"function"==typeof t}var n=Object.hasOwn||function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};class ProgramNode{constructor(t){this.type="Program",this.nodeChild=t}toArray(){return t(this.nodeChild)}toString(){return""+(this.nodeChild||NaN)}calculate(...t){return e(this.nodeChild,t)}}class ConditionNode{constructor(t,e,r){this.type="Condition",this.nodeIf=t,this.nodeThen=e,this.nodeElse=r}toArray(){return["("].concat(t(this.nodeIf),"?",t(this.nodeThen),":",t(this.nodeElse),")")}toString(){return`(${this.nodeIf||NaN} ? ${this.nodeThen||NaN} : ${this.nodeElse||NaN})`}calculate(...t){return e(this.nodeIf,t)?e(this.nodeThen,t):e(this.nodeElse,t)}}class VariableNode{constructor(t){this.type="Variable",this.variable=t}toArray(){return[this.variable]}toString(){return""+this.variable}calculate(...t){if(t)for(var e,r=t.length,a=this.variable;r-- >0;)if(n(e=t[r],a))return e[a];return NaN}}class ConstantNode{constructor(t){this.type="Constant",this.constant=t}toArray(){return[this.constant]}toString(){return""+this.constant}calculate(...t){return this.constant}}class FunctionNode{constructor(t,e){this.type="Function",this.function=t,this.nodeListOfArgs=e}toArray(){return[this.function+"("].concat(Array.prototype.concat.apply([],this.nodeListOfArgs.map((function(e,r){return 0===r?t(e):[","].concat(t(e))}))),")")}toString(){return`${this.function}(${this.nodeListOfArgs.join(", ")})`}calculate(...t){var e=this.function;if(t)for(var a,s=t.length;s-- >0;)if(n(a=t[s],e)&&r(a=a[e]))return a.apply(void 0,this.nodeListOfArgs.map((function(t){return t?t.calculate.apply(t,this):NaN}),t));return NaN}}class OperatorNode{constructor(t,e,r){this.type="Operator",this.operator=t,this.nodeLeft=e,this.nodeRight=r}toArray(){var e=this.operator,r=this.nodeLeft,n=this.nodeRight;return n?r?"!"===e||"~"===e?[NaN]:["("].concat(t(r),e,t(n),")"):"!"===e||"~"===e||"-"===e||"+"===e?[e].concat(t(n)):t(n):t(r)}toString(){var t=this.operator,e=this.nodeLeft,r=this.nodeRight,n=""+(e||NaN),a=""+(r||NaN);return r?e?"!"===t||"~"===t?"NaN":`(${n} ${t} ${a})`:"!"===t||"~"===t||"-"===t||"+"===t?t+a:a:n}calculate(...t){var a=this.operator,s=this.nodeLeft,o=this.nodeRight,i=e(s,t);if(!o)return i;var c,u=e(o,t);if(t)for(var h,l=t.length;l-- >0;)if(n(h=t[l],a)&&r(h=h[a])){c=h;break}if(!s){switch(a){case"!":return c?c(u):+!+u;case"~":return c?c(u):~+u;case"+":return c?c(0,u):+u;case"-":return c?c(0,u):-+u}return u}if(c)return c(i,u);switch(i=+i,u=+u,a){case"**":return Math.pow(i,u);case"*":return i*u;case"/":return i/u;case"%":return i%u;case"+":return i+u;case"-":return i-u;case"<<":return i<<u;case">>":return i>>u;case">>>":return i>>>u;case"<":return i<u?1:0;case"<=":return i<=u?1:0;case">":return i>u?1:0;case">=":return i>=u?1:0;case"=":case"==":return i==u?1:0;case"===":return i===u?1:0;case"!=":return i!=u?1:0;case"!==":return i!==u?1:0;case"&":return i&u;case"^":return i^u;case"|":return i|u;case"&&":return i?u:i;case"||":return i||u;case"??":return i==i?i:u}return NaN}}var a=/\?\??|\|\|?|\*\*?|&&?|<<|>>>?|[!=]=?=?|[<>]=?|(?<!\d\.?[eE])[-+]|[-+](?!\d)|[,:~^%/()[\]]/g,s=/^(\d*\.?\d*[eE]?[-+]?\d+)\s*([^]*)$/,o={"!":14,"~":14,"**":13,"*":12,"/":12,"%":12,"+":11,"-":11,"<<":10,">>":10,">>>":10,"<":9,"<=":9,">":9,">=":9,"=":8,"==":8,"!=":8,"===":8,"!==":8,"&":7,"^":6,"|":5,"&&":4,"||":3,"??":3,"?":2,":":2,",":1};function i(t){return t[t.length-1]}function c(t,e,r,n,a,s,o){var u,h,l,d;if(s[e]&&s[e].length)for(h=(u=s[e]).length;h-- >0;)if((l=u[h]-r)>-1&&l<t.length)return u.splice(h,1),[].concat(c(t.slice(0,l),e,r,n,a,s,o),c(t.slice(l+1),e,r+l+1,n,a,s,o));if(a[e]&&a[e].length)for(h=(u=a[e]).length;h-- >0;)if((l=u[h].f-r)>-1&&l<t.length&&(d=u[h].s-r)>l){u.splice(h,1);var f=i([].concat(c(t.slice(d+1),e,r+d+1,n,a,s,o))),p=i([].concat(c(t.slice(l+1,d),e,r+l+1,n,a,s,o))),N=i([].concat(c(t.slice(0,l),e,r,n,a,s,o)));return new ConditionNode(N,p,f)}if(o[e]&&o[e].length)for(h=(u=o[e]).length;h-- >0;)if((l=u[h]-r)>-1&&l<t.length){u.splice(h,1);var g=i([].concat(c(t.slice(l+1),e,r+l+1,n,a,s,o))),y=i([].concat(c(t.slice(0,l),e,r,n,a,s,o)));return new OperatorNode(t[l],y,g)}if(n[e]&&n[e].length)for(h=(u=n[e]).length;h-- >0;)if((l=u[h].f-r)>-1&&l<t.length&&(d=u[h].s-r)>l)return u.splice(h,1),"("===t[l]?i([].concat(c(t.slice(l+1,d),e+1,r+l+1,n,a,s,o))):new FunctionNode(t[l],[].concat(c(t.slice(l+2,d),e+1,r+l+2,n,a,s,o)));return(d=t.join(""))?(l=+d)!==l&&"NaN"!==d?new VariableNode(d):new ConstantNode(l):[]}function u(t,e,r,n){t[e]||(t[e]=[]),t[e][r]||(t[e][r]=[]),t[e][r][r===o["**"]?"unshift":"push"](n.length)}function h(t,e,r){u(t,e,o["*"],r),r.push("*")}function l(t){t="("+t+")",a.lastIndex=0;for(var e,r,n,l,d,f,p=[],N=0,g="",y=0,v=0,b={},w={},A={},C={},O=o["!"],k={},m={},$={};d=a.exec(t);)switch(e=d[0]){case"[":v++;break;case"]":v--;break;default:if(0!==v)break;switch(d.index>N&&(r=t.slice(N,d.index).trim())&&(")"===g&&h($,y,p),(f=r.match(s))&&("."===(r=f[1])[0]&&(r="0"+r),f[2]&&(p.push(r),h($,y,p),r=f[2])),p.push(g=r)),e){case"(":(w[y]||(w[y]=[])).push({f:p.length,s:-1}),!g||"("===g||o[g]>0||(t[d.index-1].trim()&&"NaN"!==g&&""+ +g=="NaN"?(n=w[y]&&i(w[y]))&&n.f--:(h($,y,p),(n=w[y]&&i(w[y]))&&n.f++)),y++;break;case")":(n=w[--y]&&i(w[y]))&&(n.s=p.length,(b[y]||(b[y]=[])).push(w[y].pop()));break;default:switch(")"!==g||o[e]>0||(h($,y,p),g="*"),e){case",":(k[y]||(k[y]=[])).push(p.length);break;case"?":(C[y]||(C[y]=[])).push({f:p.length,s:-1});break;case":":(n=C[y]&&i(C[y]))&&(n.s=p.length,(A[y]||(A[y]=[])).push(C[y].pop()));break;default:if("("===g||o[g]>0){if("+"!==e&&"-"!==e&&"!"!==e&&"~"!==e){N=d.index+e.length;continue}l=++O}else l=o[e];u($,y,l,p)}}N=d.index+e.length,p.push(g=e)}var x=Array.prototype.push;for(var L in $){m[L]=[];for(var E=$[L],S=E.length;S-- >0;)E[S]&&x.apply(m[L],E[S])}return new ProgramNode(i([].concat(c(p.slice(1,-1),1,1,b,A,k,m))))}export{ConditionNode,ConstantNode,FunctionNode,OperatorNode,ProgramNode,VariableNode,l as default};
