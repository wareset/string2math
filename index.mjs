/* eslint-disable */
function t(){return Array.prototype.concat.apply([],arguments)}function e(t){return t[t.length-1]}var r=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e},n=/^(NaN)?([-]?)(Infinity)?(\d*)\.?(\d*)[eE]?([-+]?\d*)$/,i=/^0+/;function s(t){var e=(0!=(t=+t)||1/t>0?""+t:"-0").match(n);return{isNaN:!!e[1],isMinus:"-"===e[2],isInfinity:!!e[3],integer:(e[4]+e[5]).replace(i,""),exponent:+e[6]-e[5].length}}function a(t){return t.isNaN?NaN:t.isInfinity?t.isMinus?-1/0:1/0:+((t.isMinus?"-":"")+(t.integer||"0")+"e"+t.exponent)}function o(t,e){if(t=+t,0===(e=+e))return 1;if(e!=e||t!=t)return NaN;if(e===1/0)return t?-1===t||1===t?NaN:t>1||t<-1?e:0:0;if(e===-1/0)return t?-1===t||1===t?NaN:t>1||t<-1?0:-e:-e;e<0&&(t=h(1,t),e=-e);for(var r=1,n=0;++n<=e;)r=c(r,t);return(e=N(e,1-n))>0&&(r=0===(r=c(r,Math.pow(t,e)))?0:r<0?-r:r),r}function u(t,e){var r=t.exponent,n=e.exponent;return r>n?n:r}function c(t,e){var r=s(t=+t),n=s(e=+e),i=u(r,n);r.exponent-=i,n.exponent-=i;var o=s(a(r)*a(n));return o.exponent+=i+i,a(o)}function h(t,e){var r=s(t=+t),n=s(e=+e),i=u(r,n);return r.exponent-=i,n.exponent-=i,a(r)/a(n)}function l(t,e){var r=s(t=+t),n=s(e=+e),i=u(r,n);r.exponent-=i,n.exponent-=i;var o=s(a(r)%a(n));return o.exponent+=i,a(o)}function N(t,e){var r=s(t=+t),n=s(e=+e),i=u(r,n);r.exponent-=i,n.exponent-=i;var o=s(a(r)+a(n));return o.exponent+=i,a(o)}function p(t,e){var r=s(t=+t),n=s(e=+e),i=u(r,n);r.exponent-=i,n.exponent-=i;var o=s(a(r)-a(n));return o.exponent+=i,a(o)}var f=/\?\??|\|\|?|\*\*?|&&?|<<|>>>?|[!=]=?=?|[<>]=?|(?<!\d\.?[eE])[-+]|[,:~^%/()[\]]/g;class ProgramNode{constructor(t){this.type="Program",this.is=t}toArray(t){return this.is?this.is.toArray(t):["NaN"]}toString(){return""+(this.is||NaN)}calculate(){return this.is?this.is.calculate.apply(this.is,arguments):NaN}}class ParenthesisNode{constructor(t){this.type="Parenthesis",this.is=t}toArray(e){var r=this.is,n=t(r?r.toArray(e):"NaN");return e&&"("!==n[0]?t("(",n,")"):n}toString(){return"("+(this.is||NaN)+")"}calculate(){return this.is?this.is.calculate.apply(this.is,arguments):NaN}}class ConditionalNode{constructor(t,e,r){this.type="Conditional",this.is=r,this.isTrue=e,this.isFalse=t}toArray(e){var r=t(this.is?this.is.toArray(e):"NaN","?",this.isTrue?this.isTrue.toArray(e):"NaN",":",this.isFalse?this.isFalse.toArray(e):"NaN");return e?t("(",r,")"):r}toString(){return`${this.is||NaN} ? ${this.isTrue||NaN} : ${this.isFalse||NaN}`}calculate(){var t=this.is,e=this.isTrue,r=this.isFalse,n=arguments;return t?t.calculate.apply(t,n):r?r.calculate.apply(e,n):NaN}}class ConstantNode{constructor(t){this.type="Constant",this.is=t}toArray(){return[this.is]}toString(){return this.is}calculate(){for(var t=this.is,e=arguments,r=e.length;r-- >0;)if(t in e[r]&&"function"!=typeof e[r][t])return e[r][t];var n=+t;return n==n||"NaN"===t?n:t}}function g(e,r){return 0===r?e.toArray(this[0]):t(",",e.toArray(this[0]))}function y(t){return t.calculate.apply(t,this)}class FunctionNode{constructor(t,e){this.type="Function",this.is=t,this.isArgs=e}toArray(e){return t(this.is,"(",t.apply(void 0,this.isArgs.map(g,[e])),")")}toString(){return`${this.is}(${this.isArgs.join(", ")})`}calculate(){for(var t=this.is,e=arguments,r=e.length;r-- >0;)if(t in e[r]&&"function"==typeof e[r][t])return e[r][t].apply(void 0,this.isArgs.map(y,e));return NaN}}class OperatorNode{constructor(t,e,r){this.type="Operator",this.is=t,this.isLeft=r,this.isRight=e}toArray(e){var r=this.is,n=this.isLeft,i=this.isRight,s=n?n.toArray(e):["NaN"],a=i?i.toArray(e):["NaN"];return i?n?"!"===r||"~"===r?["NaN"]:e?t("(",s,r,a,")"):t(s,r,a):"!"===r||"~"===r||"-"===r?t(r,a):a:s}toString(){var t=this.is,e=this.isLeft,r=this.isRight,n=""+(e||NaN),i=""+(r||NaN);return r?e?"!"===t||"~"===t?"NaN":n+" "+t+" "+i:"!"===t||"~"===t||"-"===t?t+i:i:n}calculate(){var t,e=this.is,n=this.isLeft,i=this.isRight,s=arguments,a=n?n.calculate.apply(n,s):NaN,u=i?i.calculate.apply(i,s):NaN;if(!i)return a;for(var f=s.length;f-- >0;)if(e in s[f]&&"function"==typeof s[f][e]){t=s[f][e];break}if(!n)return"-"===e?t?t(0,u):-u:"!"===e?t?t(u):+!u:"~"===e?t?t(u):~u:u;if(t)return t(a,u);switch(e){case"**":return o(a,u);case"*":return c(a,u);case"/":return h(a,u);case"%":return l(a,u);case"+":return N(a,u);case"-":return p(a,u);case"<<":return a<<u;case">>":return a>>u;case">>>":return a>>>u;case"<":return a<u?1:0;case"<=":return a<=u?1:0;case">":return a>u?1:0;case">=":return a>=u?1:0;case"=":case"==":return a==u?1:0;case"===":return r(a,u)?1:0;case"!=":return a!=u?1:0;case"!==":return r(a,u)?0:1;case"&":return a&u;case"^":return a^u;case"|":return a|u;case"&&":return a?u:a;case"||":return a||u;case"??":return a==a?a:u}return NaN}}var d={"!":14,"~":14,"**":13,"*":12,"/":12,"%":12,"+":11,"-":11,"<<":10,">>":10,">>>":10,"<":9,"<=":9,">":9,">=":9,"=":8,"==":8,"!=":8,"===":8,"!==":8,"&":7,"^":6,"|":5,"&&":4,"||":3,"??":3,"?":2,":":2,",":1};function v(r,n,i,s,a,o,u){if(o[n]&&o[n].length)for(var c,h=o[n],l=h.length;l-- >0;)if((c=h[l]-i)>-1&&c<r.length)return h.splice(l,1),t(v(r.slice(0,c),n,i,s,a,o,u),v(r.slice(c+1),n,i+c+1,s,a,o,u));if(a[n]&&a[n].length)for(var N,p,f=a[n],g=f.length;g-- >0;)if(N=f[g].f-i,p=f[g].s-i,N>-1&&N<r.length&&p>N)return f.splice(g,1),new ConditionalNode(e(t(v(r.slice(p+1),n,i+p+1,s,a,o,u))),e(t(v(r.slice(N+1,p),n,i+N+1,s,a,o,u))),e(t(v(r.slice(0,N),n,i,s,a,o,u))));if(u[n]&&u[n].length)for(var y,d=u[n],x=d.length;x-- >0;)if((y=d[x]-i)>-1&&y<r.length)return d.splice(x,1),new OperatorNode(r[y],e(t(v(r.slice(y+1),n,i+y+1,s,a,o,u))),e(t(v(r.slice(0,y),n,i,s,a,o,u))));if(s[n]&&s[n].length)for(var A,w,b=s[n],k=b.length;k-- >0;)if(A=b[k].f-i,w=b[k].s-i,A>-1&&A<r.length&&w>A)return b.splice(k,1),"("===r[A]?new ParenthesisNode(e(t(v(r.slice(A+1,w),n+1,i+A+1,s,a,o,u)))):new FunctionNode(r[A],t(v(r.slice(A+2,w),n+1,i+A+2,s,a,o,u)));var m=r.join("");return m?new ConstantNode(m):[]}function x(t,e,r,n){t[e]||(t[e]=[]),t[e][r]||(t[e][r]=[]),t[e][r][r===d["**"]?"unshift":"push"](n.length)}function A(t,e,r){x(t,e,d["*"],r),r.push("*")}function w(r){r="("+r+")",f.lastIndex=0;for(var n,i,s,a,o,u=[],c=0,h="",l=0,N=0,p={},g={},y={},w={},b=d["!"],k={},m={},F={};o=f.exec(r);)switch(n=o[0]){case"[":N++;break;case"]":N--;break;default:if(0!==N)break;switch(o.index>c&&(i=r.slice(c,o.index).trim())&&(")"===h&&A(F,l,u),u.push(h=i)),n){case"(":g[l]||(g[l]=[]),g[l].push({f:u.length,s:-1}),!h||"("===h||d[h]>0||(r[o.index-1].trim()&&"NaN"!==h&&""+ +h=="NaN"?(s=g[l]&&e(g[l]))&&s.f--:(A(F,l,u),(s=g[l]&&e(g[l]))&&s.f++)),l++;break;case")":(s=g[--l]&&e(g[l]))&&(s.s=u.length,(p[l]||(p[l]=[])).push(g[l].pop()));break;default:switch(")"!==h||d[n]>0||(A(F,l,u),h="*"),n){case",":k[l]||(k[l]=[]),k[l].push(u.length);break;case"?":w[l]||(w[l]=[]),w[l].push({f:u.length,s:-1});break;case":":(s=w[l]&&e(w[l]))&&(s.s=u.length,(y[l]||(y[l]=[])).push(w[l].pop()));break;default:if("("===h||d[h]>0){if("-"!==n&&"!"!==n&&"~"!==n){c=o.index+n.length;continue}a=++b}else a=d[n];x(F,l,a,u)}}c=o.index+n.length,u.push(h=n)}for(var C in F){m[C]=[];for(var P=F[C],S=P.length;S-- >0;)P[S]&&Array.prototype.push.apply(m[C],P[S])}return new ProgramNode(e(t(v(u.slice(1,-1),1,1,p,y,k,m))))}export{ConditionalNode,ConstantNode,FunctionNode,OperatorNode,ParenthesisNode,ProgramNode,N as add,w as create,w as default,h as div,o as exp,c as mul,s as num2raw,a as raw2num,l as rem,p as sub};
