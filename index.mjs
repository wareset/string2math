/* eslint-disable */
var e=Array.prototype;function t(){return e.concat.apply([],arguments)}function n(e){return e[e.length-1]}var r=Math.pow,i=/^([-]?)((?:NaN)?)((?:Infinity)?)(\d*)[.,]?(\d*)e?([-+]?\d*)n?$/i,s=/^0+/;function a(e){var t=(+e+"").match(i);return{neg:"-"===t[1],nan:!!t[2],inf:!!t[3],int:(t[4]+t[5]).replace(s,""),exp:+t[6]-t[5].length}}function c(e){return e.nan?NaN:e.inf?e.neg?-1/0:1/0:e.neg?-((e.int||"0")+"e"+e.exp):+((e.int||"0")+"e"+e.exp)}function u(e,t){if(0===t)return 1;if(t!=t||e!=e)return NaN;if(t===1/0)return t;if(0===e||t===-1/0)return 0;if(e===1/0||e===-1/0)return e;t<0&&(e=f(1,e),t=-t);for(var n=1,i=0;++i<=t;)n=o(n,e);return(t=p(t,1-i))>0&&(n=o(n,r(e,t))),n}function o(e,t){var n=a(e),r=a(t),i=n.exp,s=r.exp,u=(i>s?s-i:i-s)||i;n.exp-=u,r.exp-=u;var o=a(c(n)*c(r));return o.exp+=u+u,c(o)}function f(e,t){var n=a(e),r=a(t),i=n.exp,s=r.exp,u=(i>s?s-i:i-s)||i;return n.exp-=u,r.exp-=u,c(n)/c(r)}function h(e,t){var n=a(e),r=a(t),i=n.exp,s=r.exp,u=(i>s?s-i:i-s)||i;n.exp-=u,r.exp-=u;var o=a(c(n)%c(r));return o.exp+=u,c(o)}function p(e,t){var n=a(e),r=a(t),i=n.exp,s=r.exp,u=(i>s?s-i:i-s)||i;n.exp-=u,r.exp-=u;var o=a(c(n)+c(r));return o.exp+=u,c(o)}function l(e,t){return p(e,-t)}var N=/\?\??|\|\|?|\*\*?|&&?|<<|>>>?|[!=]=?=?|[<>]=?|(?<!\d\.?[eE])[-+]|[,:~^%/()[\]]/g,g=function(){function ProgramNode(e){this.type="Program",this.is=e}return ProgramNode.prototype.calc=function(){return this.is?this.is.calc(arguments):NaN},ProgramNode}(),d=function(){function ParenthesisNode(e){this.type="Parenthesis",this.is=e}return ParenthesisNode.prototype.calc=function(){return this.is?this.is.calc(arguments):NaN},ParenthesisNode}(),v=function(){function ConditionalNode(e,t,n){this.type="Conditional",this.is=n,this.isTrue=t,this.isFalse=e}return ConditionalNode.prototype.calc=function(){var e=this.is,t=(this.isTrue,this.isFalse),n=arguments;return e?e.calc(n):t?t.calc(n):NaN},ConditionalNode}(),x=function(){function ConstantNode(e){this.type="Constant",this.is=e}return ConstantNode.prototype.calc=function(){for(var e=this.is,t=arguments,n=t.length;n-- >0;)if(e in t[n]&&"function"!=typeof t[n])return+t[n][e];return+e},ConstantNode}();function y(e){return e.calc.apply(void 0,this)}var w=function(){function FunctionNode(e,t){this.type="Function",this.is=e,this.isArgs=t}return FunctionNode.prototype.calc=function(){for(var e=this.is,t=arguments,n=t.length;n-- >0;)if(e in t[n]&&"function"==typeof t[n][e])return+t[n][e].apply(void 0,this.isArgs.map(y,t));return NaN},FunctionNode}(),b=function(){function OperatorNode(e,t,n){this.type="Operator",this.is=e,this.isLeft=n,this.isRight=t}return OperatorNode.prototype.calc=function(){var e=this.is,t=this.isLeft,n=this.isRight,r=arguments,i=t?t.calc(r):NaN,s=n?n.calc(r):NaN;if(!n)return t&&"%"===e?f(i,100):i;if(!t){if(n){if("-"===e)return-s;if("!"===e)return+!s;if("~"===e)return~s}return s}for(var a=r.length;a-- >0;)if(e in r[a]&&"function"==typeof r[a][e])return+r[a][e](i,s);switch(e){case"**":return u(i,s);case"*":return o(i,s);case"/":return f(i,s);case"%":return h(i,s);case"+":return p(i,s);case"-":return p(i,-s);case"<<":return i<<s;case">>":return i>>s;case">>>":return i>>>s;case"<":return i<s?1:0;case"<=":return i<=s?1:0;case">":return i>s?1:0;case">=":return i>=s?1:0;case"=":case"==":case"===":return i===s?1:0;case"!=":case"!==":return i!==s?1:0;case"&":return i&s;case"^":return i^s;case"|":return i|s;case"&&":return i?s:i;case"||":return i||s;case"??":return i==i?i:s}return NaN},OperatorNode}(),k={"!":14,"~":14,"**":13,"*":12,"/":12,"%":12,"+":11,"-":11,"<<":10,">>":10,">>>":10,"<":9,"<=":9,">":9,">=":9,"=":8,"==":8,"!=":8,"===":8,"!==":8,"&":7,"^":6,"|":5,"&&":4,"||":3,"??":3,"?":2,":":2,",":1};function C(e,r,i,s,a,c,u){if(c[r]&&c[r].length)for(var o,f=c[r],h=f.length;h-- >0;)if((o=f[h]-i)>-1&&o<e.length)return f.splice(h,1),t(C(e.slice(0,o),r,i,s,a,c,u),C(e.slice(o+1),r,i+o+1,s,a,c,u));if(a[r]&&a[r].length)for(var p,l,N=a[r],g=N.length;g-- >0;)if(p=N[g].f-i,l=N[g].s-i,p>-1&&p<e.length&&l>p)return N.splice(g,1),new v(n(t(C(e.slice(l+1),r,i+l+1,s,a,c,u))),n(t(C(e.slice(p+1,l),r,i+p+1,s,a,c,u))),n(t(C(e.slice(0,p),r,i,s,a,c,u))));if(u[r]&&u[r].length)for(var y,P=u[r],m=P.length;m-- >0;)if((y=P[m]-i)>-1&&y<e.length){if(m>0&&(k[e[y-1]]&&"%"!==e[y-1]||"%"===e[y]&&(!e[y+1]||k[e[y+1]])))continue;return P.splice(m,1),new b(e[y],n(t(C(e.slice(y+1),r,i+y+1,s,a,c,u))),n(t(C(e.slice(0,y),r,i,s,a,c,u))))}if(s[r]&&s[r].length)for(var F,O,A=s[r],$=A.length;$-- >0;)if(F=A[$].f-i,O=A[$].s-i,F>-1&&F<e.length&&O>F)return A.splice($,1),"("===e[F]?new d(n(t(C(e.slice(F+1,O),r+1,i+F+1,s,a,c,u)))):new w(e[F],t(C(e.slice(F+2,O),r+1,i+F+2,s,a,c,u)));var I=e.join("");return I?new x(I):[]}function P(e,t,n,r){e[t]||(e[t]=[]),e[t][n]||(e[t][n]=[]),e[t][n][n===k["**"]?"unshift":"push"](r.length)}function m(e,t,n){P(e,t,k["*"],n),n.push("*")}function F(r){r="("+r+")",N.lastIndex=0;for(var i,s,a,c,u=[],o=0,f="",h=0,p=0,l={},d={},v={},x={},y={},w={},b={};c=N.exec(r);)switch(i=c[0]){case"[":p++;break;case"]":p--;break;default:if(0!==p)break;switch(c.index>o&&(s=r.slice(o,c.index).trim())&&(")"===f&&m(b,h,u),u.push(f=s)),i){case"(":d[h]||(d[h]=[]),d[h].push({f:u.length,s:-1}),f&&(/^[a-z][$\w]*$/.test(f)?(a=d[h]&&n(d[h]))&&a.f--:"("===f||k[f]||(m(b,h,u),(a=d[h]&&n(d[h]))&&a.f++)),h++;break;case")":(a=d[--h]&&n(d[h]))&&(a.s=u.length,(l[h]||(l[h]=[])).push(d[h].pop()));break;default:switch(")"!==f||k[i]||(m(b,h,u),f="*"),i){case",":y[h]||(y[h]=[]),y[h].push(u.length);break;case"?":x[h]||(x[h]=[]),x[h].push({f:u.length,s:-1});break;case":":(a=x[h]&&n(x[h]))&&(a.s=u.length,(v[h]||(v[h]=[])).push(x[h].pop()));break;default:P(b,h,k[i],u)}}u.push(f=i),o=c.index+i.length}for(var F in b){w[F]=[];for(var O=b[F],A=O.length;A-- >0;)O[A]&&e.push.apply(w[F],O[A])}return new g(n(t(C(u.slice(1,-1),1,1,l,v,y,w))))}export{v as ConditionalNode,x as ConstantNode,w as FunctionNode,b as OperatorNode,d as ParenthesisNode,g as ProgramNode,p as add,F as create,F as default,f as div,u as exp,o as mul,a as num2raw,c as raw2num,h as rem,l as sub};
