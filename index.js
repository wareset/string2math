/* eslint-disable */
Object.defineProperty(exports,"__esModule",{value:!0});var e=Math.pow,t=Array,r=t.prototype;function n(){return r.concat.apply([],arguments)}function i(e){return e[e.length-1]}var s=RegExp,o=Object,c=o.keys,u=o.create,a=t.isArray,p=o.defineProperty,f=o.setPrototypeOf;function l(e,t){return l=f?f.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function h(){h=function(e,t){return new r(e,void 0,t)};var e=s.prototype,t=new WeakMap;function r(e,n,i){var o=new s(e,n);return t.set(o,i||t.get(e)),l(o,r.prototype)}function n(e,r){var n=t.get(r);return c(n).reduce((function(t,r){var i=n[r];if("number"==typeof i)t[r]=e[i];else{for(var s=0;void 0===e[i[s]]&&s+1<i.length;)s++;t[r]=e[i[s]]}return t}),u(null))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=u(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),p(e,"prototype",{writable:!1}),t&&l(e,t)}(r,s),r.prototype.exec=function(t){var r=e.exec.call(this,t);if(r){r.groups=n(r,this);var i=r.indices;i&&(i.groups=n(i,this))}return r},r.prototype[Symbol.replace]=function(r,i){if("string"==typeof i){var s=t.get(this);return e[Symbol.replace].call(this,r,i.replace(/\$<([^>]+)>/g,(function(e,t){var r=s[t];return"$"+(a(r)?r.join("$"):r)})))}if("function"==typeof i){var o=this;return e[Symbol.replace].call(this,r,(function(){var e=arguments;return"object"!=typeof e[e.length-1]&&(e=[].slice.call(e)).push(n(e,o)),i.apply(this,e)}))}return e[Symbol.replace].call(this,r,i)},h.apply(this,arguments)}var x=h(/^(\x2D?)((?:NaN)?)((?:Infinity)?)(\d*)[.,]?(\d*)e?([-+]?\d*)n?$/i,{neg:1,nan:2,inf:3,int:4,frc:5,exp:6}),g=/^0+/;function y(e){var t=(+e+"").match(x).groups,r=t.int,n=t.frc;return t.nan=!!t.nan,t.neg="-"===t.neg,t.inf=!!t.inf,t.int=(r+n).replace(g,""),t.exp=+t.exp-n.length,delete t.frc,t}function v(e){return e.nan?NaN:e.inf?e.neg?-1/0:1/0:e.neg?0-+(e.int+"e"+e.exp):+(e.int+"e"+e.exp)}function d(e,t){var r=y(e),n=y(t),i=r.exp,s=n.exp,o=(i>s?s-i:i-s)||i;r.exp-=o,n.exp-=o;var c=y(v(r)*v(n));return c.exp+=o+o,v(c)}function N(e,t){var r=y(e),n=y(t),i=r.exp,s=n.exp,o=(i>s?s-i:i-s)||i;return r.exp-=o,n.exp-=o,v(r)/v(n)}function b(e,t){var r=y(e),n=y(t),i=r.exp,s=n.exp,o=(i>s?s-i:i-s)||i;r.exp-=o,n.exp-=o;var c=y(v(r)%v(n));return c.exp+=o,v(c)}function w(e,t){var r=y(e),n=y(t),i=r.exp,s=n.exp,o=(i>s?s-i:i-s)||i;r.exp-=o,n.exp-=o;var c=y(v(r)+v(n));return c.exp+=o,v(c)}var m=/\?\??|\|\|?|\*\*?|&&?|<<|>>>?|[!=]=?=?|[<>]=?|(?<!\d\.?[eE])[-+]|[,:~^%/()[\]]/g,k=function(){function e(e){this.type="Program",this.is=e}return e.prototype.calc=function(e,t){return this.is?this.is.calc(e,t):NaN},e}(),P=function(){function e(e){this.type="Parenthesis",this.is=e}return e.prototype.calc=function(e,t){return this.is?this.is.calc(e,t):NaN},e}(),$=function(){function e(e,t,r){this.type="Conditional",this.is=r,this.isTrue=t,this.isFalse=e}return e.prototype.calc=function(e,t){var r=this.is,n=(this.isTrue,this.isFalse);return r?r.calc(e,t):n?n.calc(e,t):NaN},e}(),_=function(){function e(e){this.type="Constant",this.is=e}return e.prototype.calc=function(e,t){var r=this.is;return+(t&&r in t&&"function"!=typeof t[r]?t[r]:e&&r in e&&"function"!=typeof e[r]?e[r]:r)},e}();function j(e){return e.calc(this[0],this[1])}var O=function(){function e(e,t){this.type="Function",this.is=e,this.isArgs=t}return e.prototype.calc=function(e,t){var r=this.is,n=t&&r in t&&"function"==typeof t[r]?t[r]:e&&r in e&&"function"==typeof e[r]?e[r]:NaN;return n&&+n.apply(void 0,this.isArgs.map(j,[e,t]))},e}(),S=function(){function t(e,t,r){this.type="Operator",this.is=e,this.isLeft=r,this.isRight=t}return t.prototype.calc=function(t,r){var n=this.is,i=this.isLeft,s=this.isRight,o=i?i.calc(t,r):NaN,c=s?s.calc(t,r):NaN;if(!s)return i&&"%"===n?N(o,100):o;if(!i){if(s){if("-"===n)return-c;if("!"===n)return+!c;if("~"===n)return~c}return c}switch(n){case"**":return e(o,c);case"*":return d(o,c);case"/":return N(o,c);case"%":return b(o,c);case"+":return w(o,c);case"-":return w(o,-c);case"<<":return o<<c;case">>":return o>>c;case">>>":return o>>>c;case"<":return o<c?1:0;case"<=":return o<=c?1:0;case">":return o>c?1:0;case">=":return o>=c?1:0;case"=":case"==":case"===":return o===c?1:0;case"!=":case"!==":return o!==c?1:0;case"&":return o&c;case"^":return o^c;case"|":return o|c;case"&&":return o?c:o;case"||":return o||c;case"??":return o==o?o:c}return NaN},t}(),A={"!":14,"~":14,"**":13,"*":12,"/":12,"%":12,"+":11,"-":11,"<<":10,">>":10,">>>":10,"<":9,"<=":9,">":9,">=":9,"=":8,"==":8,"!=":8,"===":8,"!==":8,"&":7,"^":6,"|":5,"&&":4,"||":3,"??":3,"?":2,":":2,",":1};function C(e,t,r,s,o,c,u){if(c[t]&&c[t].length)for(var a,p=c[t],f=p.length;f-- >0;)if((a=p[f]-r)>-1&&a<e.length)return p.splice(f,1),n(C(e.slice(0,a),t,r,s,o,c,u),C(e.slice(a+1),t,r+a+1,s,o,c,u));if(o[t]&&o[t].length)for(var l,h,x=o[t],g=x.length;g-- >0;)if(l=x[g].f-r,h=x[g].s-r,l>-1&&l<e.length&&h>l)return x.splice(g,1),new $(i(n(C(e.slice(h+1),t,r+h+1,s,o,c,u))),i(n(C(e.slice(l+1,h),t,r+l+1,s,o,c,u))),i(n(C(e.slice(0,l),t,r,s,o,c,u))));if(u[t]&&u[t].length)for(var y,v=u[t],d=v.length;d-- >0;)if((y=v[d]-r)>-1&&y<e.length){if(d>0&&(A[e[y-1]]&&"%"!==e[y-1]||"%"===e[y]&&(!e[y+1]||A[e[y+1]])))continue;return v.splice(d,1),new S(e[y],i(n(C(e.slice(y+1),t,r+y+1,s,o,c,u))),i(n(C(e.slice(0,y),t,r,s,o,c,u))))}if(s[t]&&s[t].length)for(var N,b,w=s[t],m=w.length;m-- >0;)if(N=w[m].f-r,b=w[m].s-r,N>-1&&N<e.length&&b>N)return w.splice(m,1),"("===e[N]?new P(i(n(C(e.slice(N+1,b),t+1,r+N+1,s,o,c,u)))):new O(e[N],n(C(e.slice(N+2,b),t+1,r+N+2,s,o,c,u)));var k=e.join("");return k?new _(k):[]}function F(e,t,r,n){e[t]||(e[t]=[]),e[t][r]||(e[t][r]=[]),e[t][r][r===A["**"]?"unshift":"push"](n.length)}function E(e,t,r){F(e,t,A["*"],r),r.push("*")}function M(e){e="("+e+")",m.lastIndex=0;for(var t,s,o,c,u=[],a=0,p="",f=0,l=0,h={},x={},g={},y={},v={},d={},N={};c=m.exec(e);)switch(t=c[0]){case"[":l++;break;case"]":l--;break;default:if(0!==l)break;switch(c.index>a&&(s=e.slice(a,c.index).trim())&&(")"===p&&E(N,f,u),u.push(p=s)),t){case"(":x[f]||(x[f]=[]),x[f].push({f:u.length,s:-1}),p&&(/^[a-z][$\w]*$/.test(p)?(o=x[f]&&i(x[f]))&&o.f--:"("===p||A[p]||(E(N,f,u),(o=x[f]&&i(x[f]))&&o.f++)),f++;break;case")":(o=x[--f]&&i(x[f]))&&(o.s=u.length,(h[f]||(h[f]=[])).push(x[f].pop()));break;default:switch(")"!==p||A[t]||(E(N,f,u),p="*"),t){case",":v[f]||(v[f]=[]),v[f].push(u.length);break;case"?":y[f]||(y[f]=[]),y[f].push({f:u.length,s:-1});break;case":":(o=y[f]&&i(y[f]))&&(o.s=u.length,(g[f]||(g[f]=[])).push(y[f].pop()));break;default:F(N,f,A[t],u)}}u.push(p=t),a=c.index+t.length}for(var b in N){d[b]=[];for(var w=N[b],P=w.length;P-- >0;)w[P]&&r.push.apply(d[b],w[P])}return new k(i(n(C(u.slice(1,-1),1,1,h,g,v,d))))}exports.NodeConditional=$,exports.NodeConstant=_,exports.NodeFunction=O,exports.NodeOperator=S,exports.NodeParenthesis=P,exports.NodeProgram=k,exports.add=w,exports.create=M,exports.default=M,exports.div=N,exports.mul=d,exports.num2raw=y,exports.raw2num=v,exports.rem=b,exports.sub=function(e,t){return w(e,-t)};
