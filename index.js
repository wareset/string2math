/* eslint-disable */
Object.defineProperty(exports,"__esModule",{value:!0});var t=Array.prototype;function e(){return t.concat.apply([],arguments)}function n(t){return t[t.length-1]}var r=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e},i=Math.pow,s=/^(NaN)?([-]?)(Infinity)?(\d*)\.?(\d*)[eE]?([-+]?\d*)$/,a=/^0+/;function o(t){var e=(0!=(t=+t)||1/t>0?""+t:"-0").match(s);return{isNaN:!!e[1],isMinus:"-"===e[2],isInfinity:!!e[3],integer:(e[4]+e[5]).replace(a,""),exponent:+e[6]-e[5].length}}function u(t){return t.isNaN?NaN:t.isInfinity?t.isMinus?-1/0:1/0:+((t.isMinus?"-":"")+(t.integer||"0")+"e"+t.exponent)}function c(t,e){if(t=+t,0===(e=+e))return 1;if(e!=e||t!=t)return NaN;if(e===1/0)return e;if(0===t||e===-1/0)return 0;if(t===1/0||t===-1/0)return t;e<0&&(t=p(1,t),e=-e);for(var n=1,r=0;++r<=e;)n=h(n,t);return(e=f(e,1-r))>0&&(n=h(n,i(t,e))),n}function h(t,e){var n=o(t),r=o(e),i=n.exponent,s=r.exponent,a=(i>s?s-i:i-s)||i;n.exponent-=a,r.exponent-=a;var c=o(u(n)*u(r));return c.exponent+=a+a,u(c)}function p(t,e){var n=o(t),r=o(e),i=n.exponent,s=r.exponent,a=(i>s?s-i:i-s)||i;return n.exponent-=a,r.exponent-=a,u(n)/u(r)}function l(t,e){var n=o(t),r=o(e),i=n.exponent,s=r.exponent,a=(i>s?s-i:i-s)||i;n.exponent-=a,r.exponent-=a;var c=o(u(n)%u(r));return c.exponent+=a,u(c)}function f(t,e){var n=o(t),r=o(e),i=n.exponent,s=r.exponent,a=(i>s?s-i:i-s)||i;n.exponent-=a,r.exponent-=a;var c=o(u(n)+u(r));return c.exponent+=a,u(c)}var N=/\?\??|\|\|?|\*\*?|&&?|<<|>>>?|[!=]=?=?|[<>]=?|(?<!\d\.?[eE])[-+]|[,:~^%/()[\]]/g,g=/^[a-z][$\w]*$/,d=function(){function ProgramNode(t){this.type="Program",this.is=t}var t=ProgramNode.prototype;return t.toArray=function(t){return this.is?this.is.toArray(t):["NaN"]},t.toString=function(){return""+(this.is||NaN)},t.calculate=function(){return this.is?this.is.calculate.apply(this.is,arguments):NaN},ProgramNode}(),y=function(){function ParenthesisNode(t){this.type="Parenthesis",this.is=t}var t=ParenthesisNode.prototype;return t.toArray=function(t){var n=this.is,r=e(n?n.toArray(t):"NaN");return t&&"("!==r[0]?e("(",r,")"):r},t.toString=function(){return"("+(this.is||NaN)+")"},t.calculate=function(){return this.is?this.is.calculate.apply(this.is,arguments):NaN},ParenthesisNode}(),x=function(){function ConditionalNode(t,e,n){this.type="Conditional",this.is=n,this.isTrue=e,this.isFalse=t}var t=ConditionalNode.prototype;return t.toArray=function(t){var n=e(this.is?this.is.toArray(t):"NaN","?",this.isTrue?this.isTrue.toArray(t):"NaN",":",this.isFalse?this.isFalse.toArray(t):"NaN");return t?e("(",n,")"):n},t.toString=function(){return(this.is||NaN)+" ? "+(this.isTrue||NaN)+" : "+(this.isFalse||NaN)},t.calculate=function(){var t=this.is,e=this.isTrue,n=this.isFalse,r=arguments;return t?t.calculate.apply(t,r):n?n.calculate.apply(e,r):NaN},ConditionalNode}(),v=function(){function ConstantNode(t){this.type="Constant",this.is=t}var t=ConstantNode.prototype;return t.toArray=function(){return[this.is]},t.toString=function(){return this.is},t.calculate=function(){for(var t=this.is,e=arguments,n=e.length;n-- >0;)if(t in e[n]&&"function"!=typeof e[n])return+e[n][t];return+t},ConstantNode}();function A(t,n){return 0===n?t.toArray(this[0]):e(",",t.toArray(this[0]))}function w(t){return t.calculate.apply(t,this)}var m=function(){function FunctionNode(t,e){this.type="Function",this.is=t,this.isArgs=e}var t=FunctionNode.prototype;return t.toArray=function(t){return e(this.is,"(",e.apply(void 0,this.isArgs.map(A,[t])),")")},t.toString=function(){return this.is+"("+this.isArgs.join(", ")+")"},t.calculate=function(){for(var t=this.is,e=arguments,n=e.length;n-- >0;)if(t in e[n]&&"function"==typeof e[n][t])return+e[n][t].apply(void 0,this.isArgs.map(w,e));return NaN},FunctionNode}(),C=function(){function OperatorNode(t,e,n){this.type="Operator",this.is=t,this.isLeft=n,this.isRight=e}var t=OperatorNode.prototype;return t.toArray=function(t){var n=this.is,r=this.isLeft,i=this.isRight,s=r?r.toArray(t):["NaN"],a=i?i.toArray(t):["NaN"];return i?r?"!"===n||"~"===n?["NaN"]:t?e("(",s,n,a,")"):e(s,n,a):"!"===n||"~"===n||"-"===n?e(n,a):a:s},t.toString=function(){var t=this.is,e=this.isLeft,n=this.isRight,r=""+(e||NaN),i=""+(n||NaN);return n?e?"!"===t||"~"===t?"NaN":r+" "+t+" "+i:"!"===t||"~"===t||"-"===t?t+i:i:r},t.calculate=function(){var t,e=this.is,n=this.isLeft,i=this.isRight,s=arguments,a=n?n.calculate.apply(n,s):NaN,o=i?i.calculate.apply(i,s):NaN;if(console.log(a,o),!i)return a;for(var u=s.length;u-- >0;)if(e in s[u]&&"function"==typeof s[u][e]){t=s[u][e];break}if(!n)return"-"===e?t?+t(0,o):-o:"!"===e?t?+t(o):+!o:"~"===e?t?+t(o):~o:o;if(t)return+t(a,o);switch(e){case"**":return c(a,o);case"*":return h(a,o);case"/":return p(a,o);case"%":return l(a,o);case"+":return f(a,o);case"-":return f(a,-o);case"<<":return a<<o;case">>":return a>>o;case">>>":return a>>>o;case"<":return a<o?1:0;case"<=":return a<=o?1:0;case">":return a>o?1:0;case">=":return a>=o?1:0;case"=":case"==":return a===o?1:0;case"===":return r(a,o)?1:0;case"!=":return a!==o?1:0;case"!==":return r(a,o)?0:1;case"&":return a&o;case"^":return a^o;case"|":return a|o;case"&&":return a?o:a;case"||":return a||o;case"??":return a==a?a:o}return NaN},OperatorNode}(),O={"!":14,"~":14,"**":13,"*":12,"/":12,"%":12,"+":11,"-":11,"<<":10,">>":10,">>>":10,"<":9,"<=":9,">":9,">=":9,"=":8,"==":8,"!=":8,"===":8,"!==":8,"&":7,"^":6,"|":5,"&&":4,"||":3,"??":3,"?":2,":":2,",":1};function b(t,r,i,s,a,o,u){if(o[r]&&o[r].length)for(var c,h=o[r],p=h.length;p-- >0;)if((c=h[p]-i)>-1&&c<t.length)return h.splice(p,1),e(b(t.slice(0,c),r,i,s,a,o,u),b(t.slice(c+1),r,i+c+1,s,a,o,u));if(a[r]&&a[r].length)for(var l,f,N=a[r],g=N.length;g-- >0;)if(l=N[g].f-i,f=N[g].s-i,l>-1&&l<t.length&&f>l)return N.splice(g,1),new x(n(e(b(t.slice(f+1),r,i+f+1,s,a,o,u))),n(e(b(t.slice(l+1,f),r,i+l+1,s,a,o,u))),n(e(b(t.slice(0,l),r,i,s,a,o,u))));if(u[r]&&u[r].length)for(var d,A=u[r],w=A.length;w-- >0;)if((d=A[w]-i)>-1&&d<t.length)return A.splice(w,1),new C(t[d],n(e(b(t.slice(d+1),r,i+d+1,s,a,o,u))),n(e(b(t.slice(0,d),r,i,s,a,o,u))));if(s[r]&&s[r].length)for(var O,P,F=s[r],R=F.length;R-- >0;)if(O=F[R].f-i,P=F[R].s-i,O>-1&&O<t.length&&P>O)return F.splice(R,1),"("===t[O]?new y(n(e(b(t.slice(O+1,P),r+1,i+O+1,s,a,o,u)))):new m(t[O],e(b(t.slice(O+2,P),r+1,i+O+2,s,a,o,u)));var S=t.join("");return S?new v(S):[]}function P(t,e,n,r){t[e]||(t[e]=[]),t[e][n]||(t[e][n]=[]),t[e][n][n===O["**"]?"unshift":"push"](r.length)}function F(t,e,n){P(t,e,O["*"],n),n.push("*")}function R(r){r="("+r+")",N.lastIndex=0;for(var i,s,a,o,u,c=[],h=0,p="",l=0,f=0,y={},x={},v={},A={},w=O["!"],m={},C={},R={};u=N.exec(r);)switch(i=u[0]){case"[":f++;break;case"]":f--;break;default:if(0!==f)break;switch(u.index>h&&(s=r.slice(h,u.index).trim())&&(")"===p&&F(R,l,c),c.push(p=s)),i){case"(":x[l]||(x[l]=[]),x[l].push({f:c.length,s:-1}),p&&(g.test(p)?(a=x[l]&&n(x[l]))&&a.f--:"("===p||O[p]||(F(R,l,c),(a=x[l]&&n(x[l]))&&a.f++)),l++;break;case")":(a=x[--l]&&n(x[l]))&&(a.s=c.length,(y[l]||(y[l]=[])).push(x[l].pop()));break;default:switch(")"!==p||O[i]||(F(R,l,c),p="*"),i){case",":m[l]||(m[l]=[]),m[l].push(c.length);break;case"?":A[l]||(A[l]=[]),A[l].push({f:c.length,s:-1});break;case":":(a=A[l]&&n(A[l]))&&(a.s=c.length,(v[l]||(v[l]=[])).push(A[l].pop()));break;default:if("("===p||O[p]>0){if("-"!==i&&"!"!==i&&"~"!==i){h=u.index+i.length;continue}o=++w}else o=O[i];P(R,l,o,c)}}h=u.index+i.length,c.push(p=8===O[i]?i[0]+"="+(i[2]||""):i)}for(var S in R){C[S]=[];for(var L=R[S],k=L.length;k-- >0;)L[k]&&t.push.apply(C[S],L[k])}return new d(n(e(b(c.slice(1,-1),1,1,y,v,m,C))))}exports.ConditionalNode=x,exports.ConstantNode=v,exports.FunctionNode=m,exports.OPERATORS={"(":"Opening parenthesis",")":"Closing parenthesis","!":"Logical NOT","~":"Bitwise NOT","**":"Exponentiation","*":"Multiplication","/":"Division","%":"Remainder","+":"Addition","-":"Subtraction","<<":"Bitwise left shift",">>":"Bitwise right shift",">>>":"Bitwise unsigned right shift","<":"Less than","<=":"Less than or equal",">":"Greater than",">=":"Greater than or equal","=":"Equality","==":"Equality","!=":"Inequality","===":"Strict equality","!==":"Strict inequality","&":"Bitwise AND","^":"Bitwise XOR","|":"Bitwise OR","&&":"Logical AND","||":"Logical OR","??":"Coalescing NaN","?":"Conditional TRUE",":":"Conditional FALSE",",":"Comma"},exports.OperatorNode=C,exports.ParenthesisNode=y,exports.ProgramNode=d,exports.add=f,exports.create=R,exports.default=R,exports.div=p,exports.exp=c,exports.mul=h,exports.num2raw=o,exports.raw2num=u,exports.rem=l,exports.sub=function(t,e){return f(t,-e)};
