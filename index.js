/* eslint-disable */
Object.defineProperty(exports,"__esModule",{value:!0});var t=Array.prototype;function e(){return t.concat.apply([],arguments)}function n(t){return t[t.length-1]}var r=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e},i=Math.pow,s=/^(NaN)?([-]?)(Infinity)?(\d*)\.?(\d*)[eE]?([-+]?\d*)$/,a=/^0+/;function o(t){var e=(0!=(t=+t)||1/t>0?""+t:"-0").match(s);return{isNaN:!!e[1],isMinus:"-"===e[2],isInfinity:!!e[3],integer:(e[4]+e[5]).replace(a,""),exponent:+e[6]-e[5].length}}function u(t){return t.isNaN?NaN:t.isInfinity?t.isMinus?-1/0:1/0:+((t.isMinus?"-":"")+(t.integer||"0")+"e"+t.exponent)}function c(t,e){if(t=+t,0===(e=+e))return 1;if(e!=e||t!=t)return NaN;if(e===1/0)return t?-1===t||1===t?NaN:t>1||t<-1?e:0:0;if(e===-1/0)return t?-1===t||1===t?NaN:t>1||t<-1?0:-e:-e;e<0&&(t=p(1,t),e=-e);for(var n=1,r=0;++r<=e;)n=l(n,t);return(e=N(e,1-r))>0&&(n=0===(n=l(n,i(t,e)))?0:n<0?-n:n),n}function h(t,e){var n=t.exponent,r=e.exponent;return n>r?r:n}function l(t,e){var n=o(t=+t),r=o(e=+e),i=h(n,r);n.exponent-=i,r.exponent-=i;var s=o(u(n)*u(r));return s.exponent+=i+i,u(s)}function p(t,e){var n=o(t=+t),r=o(e=+e),i=h(n,r);return n.exponent-=i,r.exponent-=i,u(n)/u(r)}function f(t,e){var n=o(t=+t),r=o(e=+e),i=h(n,r);n.exponent-=i,r.exponent-=i;var s=o(u(n)%u(r));return s.exponent+=i,u(s)}function N(t,e){var n=o(t=+t),r=o(e=+e),i=h(n,r);n.exponent-=i,r.exponent-=i;var s=o(u(n)+u(r));return s.exponent+=i,u(s)}function g(t,e){var n=o(t=+t),r=o(e=+e),i=h(n,r);n.exponent-=i,r.exponent-=i;var s=o(u(n)-u(r));return s.exponent+=i,u(s)}var d=/\?\??|\|\|?|\*\*?|&&?|<<|>>>?|[!=]=?=?|[<>]=?|(?<!\d\.?[eE])[-+]|[,:~^%/()[\]]/g,y=function(){function ProgramNode(t){this.type="Program",this.is=t}var t=ProgramNode.prototype;return t.toArray=function(t){return this.is?this.is.toArray(t):["NaN"]},t.toString=function(){return""+(this.is||NaN)},t.calculate=function(){return this.is?this.is.calculate.apply(this.is,arguments):NaN},ProgramNode}(),v=function(){function ParenthesisNode(t){this.type="Parenthesis",this.is=t}var t=ParenthesisNode.prototype;return t.toArray=function(t){var n=this.is,r=e(n?n.toArray(t):"NaN");return t&&"("!==r[0]?e("(",r,")"):r},t.toString=function(){return"("+(this.is||NaN)+")"},t.calculate=function(){return this.is?this.is.calculate.apply(this.is,arguments):NaN},ParenthesisNode}(),x=function(){function ConditionalNode(t,e,n){this.type="Conditional",this.is=n,this.isTrue=e,this.isFalse=t}var t=ConditionalNode.prototype;return t.toArray=function(t){var n=e(this.is?this.is.toArray(t):"NaN","?",this.isTrue?this.isTrue.toArray(t):"NaN",":",this.isFalse?this.isFalse.toArray(t):"NaN");return t?e("(",n,")"):n},t.toString=function(){return(this.is||NaN)+" ? "+(this.isTrue||NaN)+" : "+(this.isFalse||NaN)},t.calculate=function(){var t=this.is,e=this.isTrue,n=this.isFalse,r=arguments;return t?t.calculate.apply(t,r):n?n.calculate.apply(e,r):NaN},ConditionalNode}(),A=function(){function ConstantNode(t){this.type="Constant",this.is=t}var t=ConstantNode.prototype;return t.toArray=function(){return[this.is]},t.toString=function(){return this.is},t.calculate=function(){for(var t=this.is,e=arguments,n=e.length;n-- >0;)if(t in e[n]&&"function"!=typeof e[n][t])return e[n][t];var r=+t;return r==r||"NaN"===t?r:t},ConstantNode}();function w(t,n){return 0===n?t.toArray(this[0]):e(",",t.toArray(this[0]))}function m(t){return t.calculate.apply(t,this)}var C=function(){function FunctionNode(t,e){this.type="Function",this.is=t,this.isArgs=e}var t=FunctionNode.prototype;return t.toArray=function(t){return e(this.is,"(",e.apply(void 0,this.isArgs.map(w,[t])),")")},t.toString=function(){return this.is+"("+this.isArgs.join(", ")+")"},t.calculate=function(){for(var t=this.is,e=arguments,n=e.length;n-- >0;)if(t in e[n]&&"function"==typeof e[n][t])return e[n][t].apply(void 0,this.isArgs.map(m,e));return NaN},FunctionNode}(),O=function(){function OperatorNode(t,e,n){this.type="Operator",this.is=t,this.isLeft=n,this.isRight=e}var t=OperatorNode.prototype;return t.toArray=function(t){var n=this.is,r=this.isLeft,i=this.isRight,s=r?r.toArray(t):["NaN"],a=i?i.toArray(t):["NaN"];return i?r?"!"===n||"~"===n?["NaN"]:t?e("(",s,n,a,")"):e(s,n,a):"!"===n||"~"===n||"-"===n?e(n,a):a:s},t.toString=function(){var t=this.is,e=this.isLeft,n=this.isRight,r=""+(e||NaN),i=""+(n||NaN);return n?e?"!"===t||"~"===t?"NaN":r+" "+t+" "+i:"!"===t||"~"===t||"-"===t?t+i:i:r},t.calculate=function(){var t,e=this.is,n=this.isLeft,i=this.isRight,s=arguments,a=n?n.calculate.apply(n,s):NaN,o=i?i.calculate.apply(i,s):NaN;if(!i)return a;for(var u=s.length;u-- >0;)if(e in s[u]&&"function"==typeof s[u][e]){t=s[u][e];break}if(!n)return"-"===e?t?t(0,o):-o:"!"===e?t?t(o):+!o:"~"===e?t?t(o):~o:o;if(t)return t(a,o);switch(e){case"**":return c(a,o);case"*":return l(a,o);case"/":return p(a,o);case"%":return f(a,o);case"+":return N(a,o);case"-":return g(a,o);case"<<":return a<<o;case">>":return a>>o;case">>>":return a>>>o;case"<":return a<o?1:0;case"<=":return a<=o?1:0;case">":return a>o?1:0;case">=":return a>=o?1:0;case"=":case"==":return a===o?1:0;case"===":return r(a,o)?1:0;case"!=":return a!==o?1:0;case"!==":return r(a,o)?0:1;case"&":return a&o;case"^":return a^o;case"|":return a|o;case"&&":return a?o:a;case"||":return a||o;case"??":return a==a?a:o}return NaN},OperatorNode}(),b={"!":14,"~":14,"**":13,"*":12,"/":12,"%":12,"+":11,"-":11,"<<":10,">>":10,">>>":10,"<":9,"<=":9,">":9,">=":9,"=":8,"==":8,"!=":8,"===":8,"!==":8,"&":7,"^":6,"|":5,"&&":4,"||":3,"??":3,"?":2,":":2,",":1};function P(t,r,i,s,a,o,u){if(o[r]&&o[r].length)for(var c,h=o[r],l=h.length;l-- >0;)if((c=h[l]-i)>-1&&c<t.length)return h.splice(l,1),e(P(t.slice(0,c),r,i,s,a,o,u),P(t.slice(c+1),r,i+c+1,s,a,o,u));if(a[r]&&a[r].length)for(var p,f,N=a[r],g=N.length;g-- >0;)if(p=N[g].f-i,f=N[g].s-i,p>-1&&p<t.length&&f>p)return N.splice(g,1),new x(n(e(P(t.slice(f+1),r,i+f+1,s,a,o,u))),n(e(P(t.slice(p+1,f),r,i+p+1,s,a,o,u))),n(e(P(t.slice(0,p),r,i,s,a,o,u))));if(u[r]&&u[r].length)for(var d,y=u[r],w=y.length;w-- >0;)if((d=y[w]-i)>-1&&d<t.length)return y.splice(w,1),new O(t[d],n(e(P(t.slice(d+1),r,i+d+1,s,a,o,u))),n(e(P(t.slice(0,d),r,i,s,a,o,u))));if(s[r]&&s[r].length)for(var m,b,F=s[r],R=F.length;R-- >0;)if(m=F[R].f-i,b=F[R].s-i,m>-1&&m<t.length&&b>m)return F.splice(R,1),"("===t[m]?new v(n(e(P(t.slice(m+1,b),r+1,i+m+1,s,a,o,u)))):new C(t[m],e(P(t.slice(m+2,b),r+1,i+m+2,s,a,o,u)));var S=t.join("");return S?new A(S):[]}function F(t,e,n,r){t[e]||(t[e]=[]),t[e][n]||(t[e][n]=[]),t[e][n][n===b["**"]?"unshift":"push"](r.length)}function R(t,e,n){F(t,e,b["*"],n),n.push("*")}function S(r){r="("+r+")",d.lastIndex=0;for(var i,s,a,o,u,c=[],h=0,l="",p=0,f=0,N={},g={},v={},x={},A=b["!"],w={},m={},C={};u=d.exec(r);)switch(i=u[0]){case"[":f++;break;case"]":f--;break;default:if(0!==f)break;switch(u.index>h&&(s=r.slice(h,u.index).trim())&&(")"===l&&R(C,p,c),c.push(l=s)),i){case"(":g[p]||(g[p]=[]),g[p].push({f:c.length,s:-1}),!l||"("===l||b[l]>0||(r[u.index-1].trim()&&"NaN"!==l&&""+ +l=="NaN"?(a=g[p]&&n(g[p]))&&a.f--:(R(C,p,c),(a=g[p]&&n(g[p]))&&a.f++)),p++;break;case")":(a=g[--p]&&n(g[p]))&&(a.s=c.length,(N[p]||(N[p]=[])).push(g[p].pop()));break;default:switch(")"!==l||b[i]>0||(R(C,p,c),l="*"),i){case",":w[p]||(w[p]=[]),w[p].push(c.length);break;case"?":x[p]||(x[p]=[]),x[p].push({f:c.length,s:-1});break;case":":(a=x[p]&&n(x[p]))&&(a.s=c.length,(v[p]||(v[p]=[])).push(x[p].pop()));break;default:if("("===l||b[l]>0){if("-"!==i&&"!"!==i&&"~"!==i){h=u.index+i.length;continue}o=++A}else o=b[i];F(C,p,o,c)}}h=u.index+i.length,c.push(l=8===b[i]?i[0]+"="+(i[2]||""):i)}for(var O in C){m[O]=[];for(var S=C[O],L=S.length;L-- >0;)S[L]&&t.push.apply(m[O],S[L])}return new y(n(e(P(c.slice(1,-1),1,1,N,v,w,m))))}exports.ConditionalNode=x,exports.ConstantNode=A,exports.FunctionNode=C,exports.OPERATORS={"(":"Opening parenthesis",")":"Closing parenthesis","!":"Logical NOT","~":"Bitwise NOT","**":"Exponentiation","*":"Multiplication","/":"Division","%":"Remainder","+":"Addition","-":"Subtraction","<<":"Bitwise left shift",">>":"Bitwise right shift",">>>":"Bitwise unsigned right shift","<":"Less than","<=":"Less than or equal",">":"Greater than",">=":"Greater than or equal","=":"Equality","==":"Equality","!=":"Inequality","===":"Strict equality","!==":"Strict inequality","&":"Bitwise AND","^":"Bitwise XOR","|":"Bitwise OR","&&":"Logical AND","||":"Logical OR","??":"Coalescing NaN","?":"Conditional TRUE",":":"Conditional FALSE",",":"Comma"},exports.OperatorNode=O,exports.ParenthesisNode=v,exports.ProgramNode=y,exports.add=N,exports.create=S,exports.default=S,exports.div=p,exports.exp=c,exports.mul=l,exports.num2raw=o,exports.raw2num=u,exports.rem=f,exports.sub=g;
