/* eslint-disable */
Object.defineProperty(exports,"__esModule",{value:!0});var t=Array.prototype.concat;function e(){return t.apply([],arguments)}function r(t){return t[t.length-1]}class ProgramNode{constructor(t){this.type="Program",this.is=t}toArray(){return this.is?this.is.toArray():["NaN"]}toString(){return""+(this.is||NaN)}calculate(){return this.is?this.is.calculate.apply(this.is,arguments):NaN}}class ParenthesisNode{constructor(t){this.type="Parenthesis",this.is=t}toArray(){return this.is?this.is.toArray():["NaN"]}toString(){return""+(this.is||NaN)}calculate(){return this.is?this.is.calculate.apply(this.is,arguments):NaN}}class ConditionalNode{constructor(t,e,r){this.type="Conditional",this.is=r,this.isTrue=e,this.isFalse=t}toArray(){return e("(",this.is?this.is.toArray():"NaN","?",this.isTrue?this.isTrue.toArray():"NaN",":",this.isFalse?this.isFalse.toArray():"NaN",")")}toString(){return`(${this.is||NaN} ? ${this.isTrue||NaN} : ${this.isFalse||NaN})`}calculate(){var t=this.is,e=this.isTrue,r=this.isFalse,n=arguments;return t?t.calculate.apply(t,n):r?r.calculate.apply(e,n):NaN}}class ConstantNode{constructor(t){this.type="Constant",this.is=t}toArray(){return[this.is]}toString(){return""+this.is}calculate(){for(var t,e=this.is,r=arguments,n=r.length;n-- >0;)if(e in(t=r[n])&&"function"!=typeof(t=t[e]))return t;var s=+e;return s==s||"NaN"===e?s:e}}function n(t,r){return 0===r?t.toArray():e(",",t.toArray())}function s(t){return t.calculate.apply(t,this)}class FunctionNode{constructor(t,e){this.type="Function",this.is=t,this.isArgs=e}toArray(){return e(this.is+"(",e.apply(void 0,this.isArgs.map(n)),")")}toString(){return`${this.is}(${this.isArgs.join(", ")})`}calculate(){for(var t,e=this.is,r=arguments,n=r.length;n-- >0;)if(e in(t=r[n])&&"function"==typeof(t=t[e]))return t.apply(void 0,this.isArgs.map(s,r));return NaN}}class OperatorNode{constructor(t,e,r){this.type="Operator",this.is=t,this.isLeft=r,this.isRight=e}toArray(){var t=this.is,r=this.isLeft,n=this.isRight,s=r?r.toArray():["NaN"],i=n?n.toArray():["NaN"];return n?r?"!"===t||"~"===t?["NaN"]:e("(",s,t,i,")"):"!"===t||"~"===t||"-"===t?e(t,i):i:s}toString(){var t=this.is,e=this.isLeft,r=this.isRight,n=""+(e||NaN),s=""+(r||NaN);return r?e?"!"===t||"~"===t?"NaN":`(${n} ${t} ${s})`:"!"===t||"~"===t||"-"===t?t+s:s:n}calculate(){var t,e=this.is,r=this.isLeft,n=this.isRight,s=arguments,i=r?r.calculate.apply(r,s):NaN,a=n?n.calculate.apply(n,s):NaN;if(!n)return i;for(var o,u=s.length;u-- >0;)if(e in(o=s[u])&&"function"==typeof(o=o[e])){t=o;break}if(!r)return"-"===e?t?t(0,a):-a:"!"===e?t?t(a):+!a:"~"===e?t?t(a):~a:a;if(t)return t(i,a);switch(e){case"**":return Math.pow(i,a);case"*":return i*a;case"/":return i/a;case"%":return i%a;case"+":return+(i+a);case"-":return i-a;case"<<":return i<<a;case">>":return i>>a;case">>>":return i>>>a;case"<":return i<a?1:0;case"<=":return i<=a?1:0;case">":return i>a?1:0;case">=":return i>=a?1:0;case"=":case"==":return i==a?1:0;case"===":return i===a?1:0;case"!=":return i!=a?1:0;case"!==":return i!==a?1:0;case"&":return i&a;case"^":return i^a;case"|":return i|a;case"&&":return i?a:i;case"||":return i||a;case"??":return i==i?i:a}return NaN}}var i=/\?\??|\|\|?|\*\*?|&&?|<<|>>>?|[!=]=?=?|[<>]=?|(?<!\d\.?[eE])[-+]|[,:~^%/()[\]]/g,a={"!":14,"~":14,"**":13,"*":12,"/":12,"%":12,"+":11,"-":11,"<<":10,">>":10,">>>":10,"<":9,"<=":9,">":9,">=":9,"=":8,"==":8,"!=":8,"===":8,"!==":8,"&":7,"^":6,"|":5,"&&":4,"||":3,"??":3,"?":2,":":2,",":1};function o(t,n,s,i,a,u,c){if(u[n]&&u[n].length)for(var h,l=u[n],p=l.length;p-- >0;)if((h=l[p]-s)>-1&&h<t.length)return l.splice(p,1),e(o(t.slice(0,h),n,s,i,a,u,c),o(t.slice(h+1),n,s+h+1,i,a,u,c));if(a[n]&&a[n].length)for(var N,f,d=a[n],g=d.length;g-- >0;)if(N=d[g].f-s,f=d[g].s-s,N>-1&&N<t.length&&f>N)return d.splice(g,1),new ConditionalNode(r(e(o(t.slice(f+1),n,s+f+1,i,a,u,c))),r(e(o(t.slice(N+1,f),n,s+N+1,i,a,u,c))),r(e(o(t.slice(0,N),n,s,i,a,u,c))));if(c[n]&&c[n].length)for(var x,y=c[n],v=y.length;v-- >0;)if((x=y[v]-s)>-1&&x<t.length)return y.splice(v,1),new OperatorNode(t[x],r(e(o(t.slice(x+1),n,s+x+1,i,a,u,c))),r(e(o(t.slice(0,x),n,s,i,a,u,c))));if(i[n]&&i[n].length)for(var A,m,w=i[n],b=w.length;b-- >0;)if(A=w[b].f-s,m=w[b].s-s,A>-1&&A<t.length&&m>A)return w.splice(b,1),"("===t[A]?new ParenthesisNode(r(e(o(t.slice(A+1,m),n+1,s+A+1,i,a,u,c)))):new FunctionNode(t[A],e(o(t.slice(A+2,m),n+1,s+A+2,i,a,u,c)));var P=t.join("");return P?new ConstantNode(P):[]}function u(t,e,r,n){t[e]||(t[e]=[]),t[e][r]||(t[e][r]=[]),t[e][r][r===a["**"]?"unshift":"push"](n.length)}function c(t,e,r){u(t,e,a["*"],r),r.push("*")}function h(t){t="("+t+")";var n,s,h,l,p,N=[],f=0,d="",g=0,x=0,y={},v={},A={},m={},w=a["!"],b={},P={},C={};for(i.lastIndex=0;p=i.exec(t);)switch(n=p[0]){case"[":x++;break;case"]":x--;break;default:if(0!==x)break;switch(p.index>f&&(s=t.slice(f,p.index).trim())&&(")"===d&&c(C,g,N),N.push(d=s)),n){case"(":v[g]||(v[g]=[]),v[g].push({f:N.length,s:-1}),!d||"("===d||a[d]>0||(t[p.index-1].trim()&&"NaN"!==d&&""+ +d=="NaN"?(h=v[g]&&r(v[g]))&&h.f--:(c(C,g,N),(h=v[g]&&r(v[g]))&&h.f++)),g++;break;case")":(h=v[--g]&&r(v[g]))&&(h.s=N.length,(y[g]||(y[g]=[])).push(v[g].pop()));break;default:switch(")"!==d||a[n]>0||(c(C,g,N),d="*"),n){case",":b[g]||(b[g]=[]),b[g].push(N.length);break;case"?":m[g]||(m[g]=[]),m[g].push({f:N.length,s:-1});break;case":":(h=m[g]&&r(m[g]))&&(h.s=N.length,(A[g]||(A[g]=[])).push(m[g].pop()));break;default:if("("===d||a[d]>0){if("-"!==n&&"!"!==n&&"~"!==n){f=p.index+n.length;continue}l=++w}else l=a[n];u(C,g,l,N)}}f=p.index+n.length,N.push(d=n)}for(var F in C){P[F]=[];for(var k=C[F],$=k.length;$-- >0;)k[$]&&Array.prototype.push.apply(P[F],k[$])}return new ProgramNode(r(e(o(N.slice(1,-1),1,1,y,A,b,P))))}var l=/^(NaN)?([-]?)(Infinity)?(\d*)\.?(\d*)[eE]?([-+]?\d*)$/,p=/^0+/;function N(t){var e=(0!=(t=+t)||1/t>0?""+t:"-0").match(l);return{isNaN:!!e[1],isMinus:"-"===e[2],isInfinity:!!e[3],integer:(e[4]+e[5]).replace(p,""),exponent:+e[6]-e[5].length}}function f(t){return t.isNaN?NaN:t.isInfinity?t.isMinus?-1/0:1/0:+((t.isMinus?"-":"")+(t.integer||"0")+"e"+t.exponent)}function d(t,e){var r=t.exponent,n=e.exponent;return r>n?n:r}function g(t,e){var r=N(t=+t),n=N(e=+e),s=d(r,n);r.exponent-=s,n.exponent-=s;var i=N(f(r)*f(n));return i.exponent+=s+s,f(i)}function x(t,e){var r=N(t=+t),n=N(e=+e),s=d(r,n);return r.exponent-=s,n.exponent-=s,f(r)/f(n)}function y(t,e){var r=N(t=+t),n=N(e=+e),s=d(r,n);r.exponent-=s,n.exponent-=s;var i=N(f(r)+f(n));return i.exponent+=s,f(i)}exports.ConditionalNode=ConditionalNode,exports.ConstantNode=ConstantNode,exports.FunctionNode=FunctionNode,exports.OperatorNode=OperatorNode,exports.ParenthesisNode=ParenthesisNode,exports.ProgramNode=ProgramNode,exports.add=y,exports.create=h,exports.default=h,exports.div=x,exports.exp=function(t,e){if(t=+t,0===(e=+e))return 1;if(e!=e||t!=t)return NaN;if(e===1/0)return t?-1===t||1===t?NaN:t>1||t<-1?e:0:0;if(e===-1/0)return t?-1===t||1===t?NaN:t>1||t<-1?0:-e:-e;e<0&&(t=x(1,t),e=-e);for(var r=1,n=0;++n<=e;)r=g(r,t);return(e=y(e,1-n))>0&&(r=0===(r=g(r,Math.pow(t,e)))?0:r<0?-r:r),r},exports.mul=g,exports.num2raw=N,exports.raw2num=f,exports.rem=function(t,e){var r=N(t=+t),n=N(e=+e),s=d(r,n);r.exponent-=s,n.exponent-=s;var i=N(f(r)%f(n));return i.exponent+=s,f(i)},exports.sub=function(t,e){var r=N(t=+t),n=N(e=+e),s=d(r,n);r.exponent-=s,n.exponent-=s;var i=N(f(r)-f(n));return i.exponent+=s,f(i)};
