/* eslint-disable */
Object.defineProperty(exports,"__esModule",{value:!0});var e=Array,t=e.prototype;function r(){return t.concat.apply([],arguments)}function n(e){return e[e.length-1]}var i=RegExp,s=Object,o=s.keys,u=s.create,c=e.isArray,a=Math.pow,p=s.defineProperty,f=s.setPrototypeOf;function l(e,t){return l=f?f.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function h(){h=function(e,t){return new r(e,void 0,t)};var e=i.prototype,t=new WeakMap;function r(e,n,s){var o=new i(e,n);return t.set(o,s||t.get(e)),l(o,r.prototype)}function n(e,r){var n=t.get(r);return o(n).reduce((function(t,r){var i=n[r];if("number"==typeof i)t[r]=e[i];else{for(var s=0;void 0===e[i[s]]&&s+1<i.length;)s++;t[r]=e[i[s]]}return t}),u(null))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=u(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),p(e,"prototype",{writable:!1}),t&&l(e,t)}(r,i),r.prototype.exec=function(t){var r=e.exec.call(this,t);if(r){r.groups=n(r,this);var i=r.indices;i&&(i.groups=n(i,this))}return r},r.prototype[Symbol.replace]=function(r,i){if("string"==typeof i){var s=t.get(this);return e[Symbol.replace].call(this,r,i.replace(/\$<([^>]+)>/g,(function(e,t){var r=s[t];return"$"+(c(r)?r.join("$"):r)})))}if("function"==typeof i){var o=this;return e[Symbol.replace].call(this,r,(function(){var e=arguments;return"object"!=typeof e[e.length-1]&&(e=[].slice.call(e)).push(n(e,o)),i.apply(this,e)}))}return e[Symbol.replace].call(this,r,i)},h.apply(this,arguments)}var x=h(/^(\x2D?)((?:NaN)?)((?:Infinity)?)(\d*)[.,]?(\d*)e?([-+]?\d*)n?$/i,{neg:1,nan:2,inf:3,int:4,frc:5,exp:6}),g=/^0+/;function y(e){var t=(+e+"").match(x).groups,r=t.int,n=t.frc;return t.nan=!!t.nan,t.neg="-"===t.neg,t.inf=!!t.inf,t.int=(r+n).replace(g,""),t.exp=+t.exp-n.length,delete t.frc,t}function v(e){return e.nan?NaN:e.inf?e.neg?-1/0:1/0:e.neg?-((e.int||"0")+"e"+e.exp):+((e.int||"0")+"e"+e.exp)}function d(e,t){if(0===t)return 1;if(t!=t||e!=e)return NaN;if(t===1/0)return t;if(0===e||t===-1/0)return 0;if(e===1/0||e===-1/0)return e;t<0&&(e=b(1,e),t=-t);for(var r=1,n=0;++n<=t;)r=N(r,e);return(t=m(t,1-n))>0&&(r=N(r,a(e,t))),r}function N(e,t){var r=y(e),n=y(t),i=r.exp,s=n.exp,o=(i>s?s-i:i-s)||i;r.exp-=o,n.exp-=o;var u=y(v(r)*v(n));return u.exp+=o+o,v(u)}function b(e,t){var r=y(e),n=y(t),i=r.exp,s=n.exp,o=(i>s?s-i:i-s)||i;return r.exp-=o,n.exp-=o,v(r)/v(n)}function w(e,t){var r=y(e),n=y(t),i=r.exp,s=n.exp,o=(i>s?s-i:i-s)||i;r.exp-=o,n.exp-=o;var u=y(v(r)%v(n));return u.exp+=o,v(u)}function m(e,t){var r=y(e),n=y(t),i=r.exp,s=n.exp,o=(i>s?s-i:i-s)||i;r.exp-=o,n.exp-=o;var u=y(v(r)+v(n));return u.exp+=o,v(u)}var k=/\?\??|\|\|?|\*\*?|&&?|<<|>>>?|[!=]=?=?|[<>]=?|(?<!\d\.?[eE])[-+]|[,:~^%/()[\]]/g,P=function(){function e(e){this.type="Program",this.is=e}return e.prototype.calc=function(){return this.is?this.is.calc(arguments):NaN},e}(),$=function(){function e(e){this.type="Parenthesis",this.is=e}return e.prototype.calc=function(){return this.is?this.is.calc(arguments):NaN},e}(),_=function(){function e(e,t,r){this.type="Conditional",this.is=r,this.isTrue=t,this.isFalse=e}return e.prototype.calc=function(){var e=this.is,t=(this.isTrue,this.isFalse),r=arguments;return e?e.calc(r):t?t.calc(r):NaN},e}(),j=function(){function e(e){this.type="Constant",this.is=e}return e.prototype.calc=function(){for(var e=this.is,t=arguments,r=t.length;r-- >0;)if(e in t[r]&&"function"!=typeof t[r])return+t[r][e];return+e},e}();function O(e){return e.calc.apply(void 0,this)}var S=function(){function e(e,t){this.type="Function",this.is=e,this.isArgs=t}return e.prototype.calc=function(){for(var e=this.is,t=arguments,r=t.length;r-- >0;)if(e in t[r]&&"function"==typeof t[r][e])return+t[r][e].apply(void 0,this.isArgs.map(O,t));return NaN},e}(),A=function(){function e(e,t,r){this.type="Operator",this.is=e,this.isLeft=r,this.isRight=t}return e.prototype.calc=function(){var e=this.is,t=this.isLeft,r=this.isRight,n=arguments,i=t?t.calc(n):NaN,s=r?r.calc(n):NaN;if(!r)return t&&"%"===e?b(i,100):i;if(!t){if(r){if("-"===e)return-s;if("!"===e)return+!s;if("~"===e)return~s}return s}for(var o=n.length;o-- >0;)if(e in n[o]&&"function"==typeof n[o][e])return+n[o][e](i,s);switch(e){case"**":return d(i,s);case"*":return N(i,s);case"/":return b(i,s);case"%":return w(i,s);case"+":return m(i,s);case"-":return m(i,-s);case"<<":return i<<s;case">>":return i>>s;case">>>":return i>>>s;case"<":return i<s?1:0;case"<=":return i<=s?1:0;case">":return i>s?1:0;case">=":return i>=s?1:0;case"=":case"==":case"===":return i===s?1:0;case"!=":case"!==":return i!==s?1:0;case"&":return i&s;case"^":return i^s;case"|":return i|s;case"&&":return i?s:i;case"||":return i||s;case"??":return i==i?i:s}return NaN},e}(),C={"!":14,"~":14,"**":13,"*":12,"/":12,"%":12,"+":11,"-":11,"<<":10,">>":10,">>>":10,"<":9,"<=":9,">":9,">=":9,"=":8,"==":8,"!=":8,"===":8,"!==":8,"&":7,"^":6,"|":5,"&&":4,"||":3,"??":3,"?":2,":":2,",":1};function F(e,t,i,s,o,u,c){if(u[t]&&u[t].length)for(var a,p=u[t],f=p.length;f-- >0;)if((a=p[f]-i)>-1&&a<e.length)return p.splice(f,1),r(F(e.slice(0,a),t,i,s,o,u,c),F(e.slice(a+1),t,i+a+1,s,o,u,c));if(o[t]&&o[t].length)for(var l,h,x=o[t],g=x.length;g-- >0;)if(l=x[g].f-i,h=x[g].s-i,l>-1&&l<e.length&&h>l)return x.splice(g,1),new _(n(r(F(e.slice(h+1),t,i+h+1,s,o,u,c))),n(r(F(e.slice(l+1,h),t,i+l+1,s,o,u,c))),n(r(F(e.slice(0,l),t,i,s,o,u,c))));if(c[t]&&c[t].length)for(var y,v=c[t],d=v.length;d-- >0;)if((y=v[d]-i)>-1&&y<e.length){if(d>0&&(C[e[y-1]]&&"%"!==e[y-1]||"%"===e[y]&&(!e[y+1]||C[e[y+1]])))continue;return v.splice(d,1),new A(e[y],n(r(F(e.slice(y+1),t,i+y+1,s,o,u,c))),n(r(F(e.slice(0,y),t,i,s,o,u,c))))}if(s[t]&&s[t].length)for(var N,b,w=s[t],m=w.length;m-- >0;)if(N=w[m].f-i,b=w[m].s-i,N>-1&&N<e.length&&b>N)return w.splice(m,1),"("===e[N]?new $(n(r(F(e.slice(N+1,b),t+1,i+N+1,s,o,u,c)))):new S(e[N],r(F(e.slice(N+2,b),t+1,i+N+2,s,o,u,c)));var k=e.join("");return k?new j(k):[]}function E(e,t,r,n){e[t]||(e[t]=[]),e[t][r]||(e[t][r]=[]),e[t][r][r===C["**"]?"unshift":"push"](n.length)}function M(e,t,r){E(e,t,C["*"],r),r.push("*")}function R(e){e="("+e+")",k.lastIndex=0;for(var i,s,o,u,c=[],a=0,p="",f=0,l=0,h={},x={},g={},y={},v={},d={},N={};u=k.exec(e);)switch(i=u[0]){case"[":l++;break;case"]":l--;break;default:if(0!==l)break;switch(u.index>a&&(s=e.slice(a,u.index).trim())&&(")"===p&&M(N,f,c),c.push(p=s)),i){case"(":x[f]||(x[f]=[]),x[f].push({f:c.length,s:-1}),p&&(/^[a-z][$\w]*$/.test(p)?(o=x[f]&&n(x[f]))&&o.f--:"("===p||C[p]||(M(N,f,c),(o=x[f]&&n(x[f]))&&o.f++)),f++;break;case")":(o=x[--f]&&n(x[f]))&&(o.s=c.length,(h[f]||(h[f]=[])).push(x[f].pop()));break;default:switch(")"!==p||C[i]||(M(N,f,c),p="*"),i){case",":v[f]||(v[f]=[]),v[f].push(c.length);break;case"?":y[f]||(y[f]=[]),y[f].push({f:c.length,s:-1});break;case":":(o=y[f]&&n(y[f]))&&(o.s=c.length,(g[f]||(g[f]=[])).push(y[f].pop()));break;default:E(N,f,C[i],c)}}c.push(p=i),a=u.index+i.length}for(var b in N){d[b]=[];for(var w=N[b],m=w.length;m-- >0;)w[m]&&t.push.apply(d[b],w[m])}return new P(n(r(F(c.slice(1,-1),1,1,h,g,v,d))))}exports.NodeConditional=_,exports.NodeConstant=j,exports.NodeFunction=S,exports.NodeOperator=A,exports.NodeParenthesis=$,exports.NodeProgram=P,exports.add=m,exports.create=R,exports.default=R,exports.div=b,exports.exp=d,exports.mul=N,exports.num2raw=y,exports.raw2num=v,exports.rem=w,exports.sub=function(e,t){return m(e,-t)};
