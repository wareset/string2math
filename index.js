/* eslint-disable */
Object.defineProperty(exports,"__esModule",{value:!0});var e=Array.prototype;function t(){return e.concat.apply([],arguments)}function r(e){return e[e.length-1]}var n=Math.pow,i=/^([-]?)((?:NaN)?)((?:Infinity)?)(\d*)[.,]?(\d*)e?([-+]?\d*)n?$/i,s=/^0+/;function o(e){var t=(+e+"").match(i);return{neg:"-"===t[1],nan:!!t[2],inf:!!t[3],int:(t[4]+t[5]).replace(s,""),exp:+t[6]-t[5].length}}function a(e){return e.nan?NaN:e.inf?e.neg?-1/0:1/0:e.neg?-((e.int||"0")+"e"+e.exp):+((e.int||"0")+"e"+e.exp)}function u(e,t){if(0===t)return 1;if(t!=t||e!=e)return NaN;if(t===1/0)return t;if(0===e||t===-1/0)return 0;if(e===1/0||e===-1/0)return e;t<0&&(e=p(1,e),t=-t);for(var r=1,i=0;++i<=t;)r=c(r,e);return(t=h(t,1-i))>0&&(r=c(r,n(e,t))),r}function c(e,t){var r=o(e),n=o(t),i=r.exp,s=n.exp,u=(i>s?s-i:i-s)||i;r.exp-=u,n.exp-=u;var c=o(a(r)*a(n));return c.exp+=u+u,a(c)}function p(e,t){var r=o(e),n=o(t),i=r.exp,s=n.exp,u=(i>s?s-i:i-s)||i;return r.exp-=u,n.exp-=u,a(r)/a(n)}function f(e,t){var r=o(e),n=o(t),i=r.exp,s=n.exp,u=(i>s?s-i:i-s)||i;r.exp-=u,n.exp-=u;var c=o(a(r)%a(n));return c.exp+=u,a(c)}function h(e,t){var r=o(e),n=o(t),i=r.exp,s=n.exp,u=(i>s?s-i:i-s)||i;r.exp-=u,n.exp-=u;var c=o(a(r)+a(n));return c.exp+=u,a(c)}var l=/\?\??|\|\|?|\*\*?|&&?|<<|>>>?|[!=]=?=?|[<>]=?|(?<!\d\.?[eE])[-+]|[,:~^%/()[\]]/g,d=function(){function ProgramNode(e){this.type="Program",this.is=e}return ProgramNode.prototype.calc=function(){return this.is?this.is.calc(arguments):NaN},ProgramNode}(),x=function(){function ParenthesisNode(e){this.type="Parenthesis",this.is=e}return ParenthesisNode.prototype.calc=function(){return this.is?this.is.calc(arguments):NaN},ParenthesisNode}(),N=function(){function ConditionalNode(e,t,r){this.type="Conditional",this.is=r,this.isTrue=t,this.isFalse=e}return ConditionalNode.prototype.calc=function(){var e=this.is,t=(this.isTrue,this.isFalse),r=arguments;return e?e.calc(r):t?t.calc(r):NaN},ConditionalNode}(),g=function(){function ConstantNode(e){this.type="Constant",this.is=e}return ConstantNode.prototype.calc=function(){for(var e=this.is,t=arguments,r=t.length;r-- >0;)if(e in t[r]&&"function"!=typeof t[r])return+t[r][e];return+e},ConstantNode}();function v(e){return e.calc.apply(void 0,this)}var y=function(){function FunctionNode(e,t){this.type="Function",this.is=e,this.isArgs=t}return FunctionNode.prototype.calc=function(){for(var e=this.is,t=arguments,r=t.length;r-- >0;)if(e in t[r]&&"function"==typeof t[r][e])return+t[r][e].apply(void 0,this.isArgs.map(v,t));return NaN},FunctionNode}(),w=function(){function OperatorNode(e,t,r){this.type="Operator",this.is=e,this.isLeft=r,this.isRight=t}return OperatorNode.prototype.calc=function(){var e=this.is,t=this.isLeft,r=this.isRight,n=arguments,i=t?t.calc(n):NaN,s=r?r.calc(n):NaN;if(!r)return t&&"%"===e?p(i,100):i;if(!t){if(r){if("-"===e)return-s;if("!"===e)return+!s;if("~"===e)return~s}return s}for(var o=n.length;o-- >0;)if(e in n[o]&&"function"==typeof n[o][e])return+n[o][e](i,s);switch(e){case"**":return u(i,s);case"*":return c(i,s);case"/":return p(i,s);case"%":return f(i,s);case"+":return h(i,s);case"-":return h(i,-s);case"<<":return i<<s;case">>":return i>>s;case">>>":return i>>>s;case"<":return i<s?1:0;case"<=":return i<=s?1:0;case">":return i>s?1:0;case">=":return i>=s?1:0;case"=":case"==":case"===":return i===s?1:0;case"!=":case"!==":return i!==s?1:0;case"&":return i&s;case"^":return i^s;case"|":return i|s;case"&&":return i?s:i;case"||":return i||s;case"??":return i==i?i:s}return NaN},OperatorNode}(),m={"!":14,"~":14,"**":13,"*":12,"/":12,"%":12,"+":11,"-":11,"<<":10,">>":10,">>>":10,"<":9,"<=":9,">":9,">=":9,"=":8,"==":8,"!=":8,"===":8,"!==":8,"&":7,"^":6,"|":5,"&&":4,"||":3,"??":3,"?":2,":":2,",":1};function P(e,n,i,s,o,a,u){if(a[n]&&a[n].length)for(var c,p=a[n],f=p.length;f-- >0;)if((c=p[f]-i)>-1&&c<e.length)return p.splice(f,1),t(P(e.slice(0,c),n,i,s,o,a,u),P(e.slice(c+1),n,i+c+1,s,o,a,u));if(o[n]&&o[n].length)for(var h,l,d=o[n],v=d.length;v-- >0;)if(h=d[v].f-i,l=d[v].s-i,h>-1&&h<e.length&&l>h)return d.splice(v,1),new N(r(t(P(e.slice(l+1),n,i+l+1,s,o,a,u))),r(t(P(e.slice(h+1,l),n,i+h+1,s,o,a,u))),r(t(P(e.slice(0,h),n,i,s,o,a,u))));if(u[n]&&u[n].length)for(var b,C=u[n],k=C.length;k-- >0;)if((b=C[k]-i)>-1&&b<e.length){if(k>0&&(m[e[b-1]]&&"%"!==e[b-1]||"%"===e[b]&&(!e[b+1]||m[e[b+1]])))continue;return C.splice(k,1),new w(e[b],r(t(P(e.slice(b+1),n,i+b+1,s,o,a,u))),r(t(P(e.slice(0,b),n,i,s,o,a,u))))}if(s[n]&&s[n].length)for(var F,O,A=s[n],$=A.length;$-- >0;)if(F=A[$].f-i,O=A[$].s-i,F>-1&&F<e.length&&O>F)return A.splice($,1),"("===e[F]?new x(r(t(P(e.slice(F+1,O),n+1,i+F+1,s,o,a,u)))):new y(e[F],t(P(e.slice(F+2,O),n+1,i+F+2,s,o,a,u)));var j=e.join("");return j?new g(j):[]}function b(e,t,r,n){e[t]||(e[t]=[]),e[t][r]||(e[t][r]=[]),e[t][r][r===m["**"]?"unshift":"push"](n.length)}function C(e,t,r){b(e,t,m["*"],r),r.push("*")}function k(n){n="("+n+")",l.lastIndex=0;for(var i,s,o,a,u=[],c=0,p="",f=0,h=0,x={},N={},g={},v={},y={},w={},k={};a=l.exec(n);)switch(i=a[0]){case"[":h++;break;case"]":h--;break;default:if(0!==h)break;switch(a.index>c&&(s=n.slice(c,a.index).trim())&&(")"===p&&C(k,f,u),u.push(p=s)),i){case"(":N[f]||(N[f]=[]),N[f].push({f:u.length,s:-1}),p&&(/^[a-z][$\w]*$/.test(p)?(o=N[f]&&r(N[f]))&&o.f--:"("===p||m[p]||(C(k,f,u),(o=N[f]&&r(N[f]))&&o.f++)),f++;break;case")":(o=N[--f]&&r(N[f]))&&(o.s=u.length,(x[f]||(x[f]=[])).push(N[f].pop()));break;default:switch(")"!==p||m[i]||(C(k,f,u),p="*"),i){case",":y[f]||(y[f]=[]),y[f].push(u.length);break;case"?":v[f]||(v[f]=[]),v[f].push({f:u.length,s:-1});break;case":":(o=v[f]&&r(v[f]))&&(o.s=u.length,(g[f]||(g[f]=[])).push(v[f].pop()));break;default:b(k,f,m[i],u)}}u.push(p=i),c=a.index+i.length}for(var F in k){w[F]=[];for(var O=k[F],A=O.length;A-- >0;)O[A]&&e.push.apply(w[F],O[A])}return new d(r(t(P(u.slice(1,-1),1,1,x,g,y,w))))}exports.ConditionalNode=N,exports.ConstantNode=g,exports.FunctionNode=y,exports.OperatorNode=w,exports.ParenthesisNode=x,exports.ProgramNode=d,exports.add=h,exports.create=k,exports.default=k,exports.div=p,exports.exp=u,exports.mul=c,exports.num2raw=o,exports.raw2num=a,exports.rem=f,exports.sub=function(e,t){return h(e,-t)};
